<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø¸Ø§Ù… Ø§Ù„Ø¬Ø±Ø¯ Ø§Ù„ÙŠÙˆÙ…ÙŠ - Ø´Ø±ÙƒØ© Ù†Ø§ÙŠÙ Ù„Ù„Ø£ØºØ°ÙŠØ©</title>
    <link rel="icon" href="https://i.postimg.cc/NM2zJWZD/NAIF-LOGO.jpg" type="image/jpeg">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        :root {
            --primary-red: #c53030;
            --light-red: #fff5f5;
            --dark-red: #742a2a;
            --success-color: #38a169;
            --warning-color: #ed8936;
            --danger-color: #c53030;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: #f7fafc;
            color: #333;
            line-height: 1.5;
            padding: 15px;
            position: relative;
            min-height: 100vh;
        }

        body::before {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: url('https://i.postimg.cc/NM2zJWZD/NAIF-LOGO.jpg');
            background-size: 400px;
            background-repeat: no-repeat;
            background-position: center;
            opacity: 0.05;
            z-index: -1;
            pointer-events: none;
        }

        .container {
            max-width: 2000px;
            margin: 0 auto;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            border: 1px solid #e2e8f0;
        }

        .header {
            background: linear-gradient(135deg, var(--dark-red), var(--primary-red));
            color: white;
            padding: 15px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            border-bottom: 2px solid rgba(255, 255, 255, 0.2);
        }

        .header-content {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: 2px solid white;
            overflow: hidden;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            background: white;
        }

        .logo img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .title-section {
            display: flex;
            flex-direction: column;
        }

        .title {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 3px;
        }

        .subtitle {
            font-size: 14px;
            opacity: 0.9;
        }

        .date-display {
            background-color: rgba(255, 255, 255, 0.2);
            padding: 8px 15px;
            border-radius: 5px;
            font-size: 14px;
            font-weight: 500;
        }

        .controls {
            padding: 15px 20px;
            background-color: var(--light-red);
            border-bottom: 1px solid #fed7d7;
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            align-items: center;
        }

        .control-group {
            display: flex;
            flex-direction: column;
            min-width: 200px;
            flex: 1;
        }

        .control-label {
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--dark-red);
            font-size: 13px;
        }

        .search-container {
            position: relative;
            width: 100%;
        }

        .control-input, .search-input, .search-suggestions {
            padding: 8px 12px;
            border-radius: 5px;
            border: 1px solid #cbd5e0;
            font-size: 14px;
            transition: all 0.2s;
            width: 100%;
        }

        .search-input {
            padding-right: 35px;
        }

        .search-icon {
            position: absolute;
            left: 10px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--primary-red);
        }

        .search-suggestions {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #cbd5e0;
            border-top: none;
            border-radius: 0 0 5px 5px;
            max-height: 200px;
            overflow-y: auto;
            z-index: 100;
            display: none;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .search-suggestion {
            padding: 8px 12px;
            cursor: pointer;
            border-bottom: 1px solid #f0f0f0;
            font-size: 14px;
            text-align: right;
        }

        .search-suggestion:hover {
            background-color: var(--light-red);
        }

        .search-suggestion:last-child {
            border-bottom: none;
        }

        .control-button {
            background: linear-gradient(135deg, var(--primary-red), var(--dark-red));
            color: white;
            border: none;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 8px 15px;
            min-width: 140px;
            transition: all 0.2s;
            font-size: 14px;
            border-radius: 5px;
        }

        .control-button:hover {
            background: linear-gradient(135deg, var(--dark-red), var(--primary-red));
            transform: translateY(-1px);
        }

        .control-button:active {
            transform: translateY(0);
        }

        .control-button.warning {
            background: linear-gradient(135deg, #ed8936, #dd6b20);
        }

        .control-button.warning:hover {
            background: linear-gradient(135deg, #dd6b20, #ed8936);
        }

        .control-button.danger {
            background: linear-gradient(135deg, #e53e3e, #c53030);
        }

        .control-button.danger:hover {
            background: linear-gradient(135deg, #c53030, #e53e3e);
        }

        .buttons-container {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 5px;
        }

        .main-content {
            padding: 15px;
            overflow-x: auto;
        }

        .table-container {
            overflow-x: auto;
            margin-bottom: 20px;
            border-radius: 5px;
            border: 1px solid #e2e8f0;
            background: white;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
            min-width: 1700px;
        }

        .data-table th {
            background: linear-gradient(135deg, var(--primary-red), var(--dark-red));
            color: white;
            padding: 10px 8px;
            text-align: center;
            font-weight: 600;
            border: 1px solid #fed7d7;
            position: sticky;
            top: 0;
            z-index: 10;
            font-size: 13px;
            white-space: nowrap;
        }

        .data-table td {
            padding: 8px 6px;
            border: 1px solid #e2e8f0;
            text-align: center;
            transition: background-color 0.2s;
            font-size: 13px;
        }

        .data-table td.item-name {
            text-align: right;
            padding-right: 15px;
            direction: rtl;
        }

        .data-table tr:nth-child(even) {
            background-color: #f8f9fa;
        }

        .data-table tr:hover {
            background-color: #f1f5f9;
        }

        .data-table .positive {
            color: var(--success-color);
            font-weight: 600;
        }

        .data-table .negative {
            color: var(--danger-color);
            font-weight: 600;
        }

        .data-table .deduction {
            color: var(--danger-color);
            font-weight: 600;
        }

        .data-table .zero {
            color: #a0aec0;
            font-style: italic;
        }

        .data-table .grouped-difference {
            font-size: 15px;
            font-weight: bold;
            padding: 10px 6px;
            background-color: #f8f9fa;
            border-left: 3px solid var(--primary-red);
            border-right: 3px solid var(--primary-red);
        }

        .data-table .grouped-difference.positive {
            color: var(--success-color);
            background-color: #f0fff4;
        }

        .data-table .grouped-difference.negative {
            color: var(--danger-color);
            background-color: #fff5f5;
        }

        .footer {
            text-align: center;
            padding: 15px;
            color: #666;
            font-size: 13px;
            border-top: 1px solid #e2e8f0;
            background-color: #f8f9fa;
        }

        /* PDF Template */
        .pdf-template {
            position: fixed;
            left: -10000px;
            top: -10000px;
            width: 1123px;
            height: 794px;
            background: white;
            padding: 10px;
            box-sizing: border-box;
            z-index: -1000;
            font-size: 12px;
            font-family: 'Times New Roman', serif;
        }

        .file-input-container {
            position: relative;
            display: inline-block;
        }

        .file-input {
            position: absolute;
            left: 0;
            top: 0;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }

        .file-input-label {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 15px;
            background: linear-gradient(135deg, var(--primary-red), var(--dark-red));
            color: white;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                text-align: center;
                gap: 10px;
                padding: 12px;
            }
            
            .header-content {
                flex-direction: column;
            }
            
            .controls {
                padding: 12px;
            }
            
            .control-group {
                width: 100%;
            }
            
            .buttons-container {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-content">
                <div class="logo">
                    <img src="https://i.postimg.cc/NM2zJWZD/NAIF-LOGO.jpg" alt="Ø´Ø¹Ø§Ø± Ù†Ø§ÙŠÙ Ù„Ù„Ø£ØºØ°ÙŠØ©">
                </div>
                <div class="title-section">
                    <h1 class="title">Ø´Ø±ÙƒØ© Ù†Ø§ÙŠÙ Ù„Ù„Ø£ØºØ°ÙŠØ©</h1>
                    <p class="subtitle">Ù†Ø¸Ø§Ù… Ø§Ù„Ø¬Ø±Ø¯ Ø§Ù„ÙŠÙˆÙ…ÙŠ Ù„Ù„Ù…Ø·Ø§Ø¹Ù…</p>
                </div>
            </div>
            <div class="date-display" id="current-date"></div>
        </div>
        
        <div class="controls">
            <div class="control-group">
                <label class="control-label">Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ø·Ø¹Ù…:</label>
                <div class="search-container">
                    <input type="text" class="search-input" id="restaurant-search" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ù…Ø·Ø¹Ù…...">
                    <div class="search-icon">ğŸ”</div>
                    <div class="search-suggestions" id="restaurant-suggestions"></div>
                </div>
            </div>
            
            <div class="control-group">
                <label class="control-label">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¬Ø±Ø¯:</label>
                <input type="date" class="control-input" id="inventory-date" value="2026-01-08">
            </div>
            
            <div class="buttons-container">
                <div class="file-input-container">
                    <input type="file" class="file-input" id="excel-file" accept=".xlsx,.xls,.xlsm">
                    <label class="file-input-label" for="excel-file">
                        <span>ğŸ“‚</span>
                        ØªØ­Ù…ÙŠÙ„ Ù…Ù† Excel
                    </label>
                </div>
                <button class="control-button" id="export-pdf">
                    <span>ğŸ“„</span>
                    ØªØµØ¯ÙŠØ± PDF
                </button>
                <button class="control-button danger" id="clear-data">
                    <span>ğŸ—‘ï¸</span>
                    Ù…Ø³Ø­ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                </button>
            </div>
        </div>
        
        <div class="main-content">
            <div class="table-container">
                <table class="data-table" id="inventory-table">
                    <thead>
                        <tr>
                            <th width="6%">Ø§Ù„ÙƒÙˆØ¯</th>
                            <th width="15%">Ø§Ù„ØµÙ†Ù Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ</th>
                            <th width="6%">Ø±ØµÙŠØ¯ Ø£ÙˆÙ„</th>
                            <th width="6%">Ø§Ù„ÙˆØ­Ø¯Ø©</th>
                            <th width="6%">Ø§Ø³ØªÙ„Ø§Ù…</th>
                            <th width="8%">Ø§Ù„ØªØ­ÙˆÙŠÙ„Ø§Øª Ø§Ù„Ø¯Ø§Ø®Ù„Ø©</th>
                            <th width="8%">Ø§Ù„ØªØ­ÙˆÙŠÙ„Ø§Øª Ø§Ù„Ø®Ø§Ø±Ø¬Ø©</th>
                            <th width="6%">Ø§Ù„ØªÙˆØ§Ù„Ù</th>
                            <th width="6%">Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</th>
                            <th width="8%">Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ø¥Ù‚ÙØ§Ù„</th>
                            <th width="8%">Ø§Ù„Ø¬Ø±Ø¯ Ø§Ù„ÙØ¹Ù„ÙŠ</th>
                            <th width="6%">Ø§Ù„ÙØ±Ù‚</th>
                            <th width="9%">ØªØ¬Ù…ÙŠØ¹ Ø§Ù„ÙØ±ÙˆÙ‚Ø§Øª</th>
                            <th width="8%">Ø±ØµÙŠØ¯ Ø¢Ø®Ø±</th>
                            <th width="9%">Ø§Ù„ÙØ±Ù‚ Ø¨ÙŠÙ† Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ ÙˆØ§Ù„Ù…ØªØ¨Ù‚ÙŠ</th>
                        </tr>
                    </thead>
                    <tbody id="table-body">
                        <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>
        
        <div class="footer">
            <p>Â© 2026 Ù†Ø¸Ø§Ù… Ø§Ù„Ø¬Ø±Ø¯ Ø§Ù„ÙŠÙˆÙ…ÙŠ - Ø´Ø±ÙƒØ© Ù†Ø§ÙŠÙ Ù„Ù„Ø£ØºØ°ÙŠØ©</p>
        </div>
    </div>

    <!-- PDF Template -->
    <div id="pdf-template" class="pdf-template">
        <div class="pdf-header" style="padding: 5px; margin-bottom: 5px;">
            <div class="pdf-header-row" style="text-align: center;">
                <div style="text-align: center; margin-bottom: 5px;">
                    <img src="https://i.postimg.cc/NM2zJWZD/NAIF-LOGO.jpg" alt="Ø´Ø¹Ø§Ø± Ø§Ù„Ø´Ø±ÙƒØ©" 
                         style="width: 40px; height: 40px; border-radius: 50%; border: 2px solid #c53030; margin: 0 auto 3px; display: block;">
                    <h2 style="color: #c53030; margin: 0; font-size: 16px;">
                        Ø´Ø±ÙƒØ© Ù†Ø§ÙŠÙ Ù„Ù„Ø£ØºØ°ÙŠØ©
                    </h2>
                </div>
                <h3 style="color: #c53030; margin: 0 0 5px 0; font-size: 14px;">ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø¬Ø±Ø¯ Ø§Ù„ÙŠÙˆÙ…ÙŠ</h3>
                <div style="margin-bottom: 5px; text-align: center; font-size: 12px;">
                    <div style="display: inline-block;">
                        Ø§Ù„Ù…Ø·Ø¹Ù…: <span id="pdf-restaurant-name"></span>
                    </div>
                    <div style="display: inline-block; width: 1cm;"></div>
                    <div style="display: inline-block;">
                        ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¬Ø±Ø¯: <span id="pdf-inventory-date"></span>
                    </div>
                </div>
            </div>
        </div>
        
        <table class="statement-table" id="pdf-statement-table" style="font-size: 10px; border-collapse: collapse; width: 100%;">
            <thead>
                <tr>
                    <th width="6%" style="padding: 4px; border: 1px solid #000; text-align: center; background: #c53030; color: white;">Ø§Ù„ÙƒÙˆØ¯</th>
                    <th width="15%" style="padding: 4px; border: 1px solid #000; text-align: center; background: #c53030; color: white;">Ø§Ù„ØµÙ†Ù</th>
                    <th width="6%" style="padding: 4px; border: 1px solid #000; text-align: center; background: #c53030; color: white;">Ø±ØµÙŠØ¯ Ø£ÙˆÙ„</th>
                    <th width="6%" style="padding: 4px; border: 1px solid #000; text-align: center; background: #c53030; color: white;">Ø§Ù„ÙˆØ­Ø¯Ø©</th>
                    <th width="6%" style="padding: 4px; border: 1px solid #000; text-align: center; background: #c53030; color: white;">Ø§Ø³ØªÙ„Ø§Ù…</th>
                    <th width="8%" style="padding: 4px; border: 1px solid #000; text-align: center; background: #c53030; color: white;">ØªØ­ÙˆÙŠÙ„ Ø¯Ø§Ø®Ù„Ø©</th>
                    <th width="8%" style="padding: 4px; border: 1px solid #000; text-align: center; background: #c53030; color: white;">ØªØ­ÙˆÙŠÙ„ Ø®Ø§Ø±Ø¬Ø©</th>
                    <th width="6%" style="padding: 4px; border: 1px solid #000; text-align: center; background: #c53030; color: white;">ØªÙˆØ§Ù„Ù</th>
                    <th width="6%" style="padding: 4px; border: 1px solid #000; text-align: center; background: #c53030; color: white;">Ù…Ø¨ÙŠØ¹Ø§Øª</th>
                    <th width="8%" style="padding: 4px; border: 1px solid #000; text-align: center; background: #c53030; color: white;">Ù…ØªØ¨Ù‚ÙŠ Ø¥Ù‚ÙØ§Ù„</th>
                    <th width="8%" style="padding: 4px; border: 1px solid #000; text-align: center; background: #c53030; color: white;">Ø¬Ø±Ø¯ ÙØ¹Ù„ÙŠ</th>
                    <th width="6%" style="padding: 4px; border: 1px solid #000; text-align: center; background: #c53030; color: white;">Ø§Ù„ÙØ±Ù‚</th>
                    <th width="9%" style="padding: 4px; border: 1px solid #000; text-align: center; background: #c53030; color: white;">ØªØ¬Ù…ÙŠØ¹ Ø§Ù„ÙØ±ÙˆÙ‚Ø§Øª</th>
                    <th width="9%" style="padding: 4px; border: 1px solid #000; text-align: center; background: #c53030; color: white;">ÙØ±Ù‚ Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬</th>
                </tr>
            </thead>
            <tbody id="pdf-table-body" style="font-size: 9px;">
            </tbody>
        </table>
    </div>

    <script>
        // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ø§Ø¹Ù… - Ù…Ø­Ø¯Ø«Ø© Ù„ØªØ´Ù…Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø·Ø§Ø¹Ù… Ù…Ù† Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù…Ø±ÙÙ‚
        const restaurants = [
            "Ø§Ù„ÙØ±ÙˆØ§Ù†ÙŠØ©",
            "Ø§Ù„Ø§ÙÙŠÙ†ÙŠÙˆØ²", 
            "Ø§Ù„Ø¬Ø§Ø¨Ø±ÙŠØ© Ø¨Ù†Øª Ø§Ù„Ø¯ÙŠÙƒ",
            "Ø§Ù„Ø¬Ø§Ø¨Ø±ÙŠØ© ØªÙƒØ§ Ùˆ ÙØ±Ø§ÙŠØ¯",
            "Ø§Ù„Ø¬Ù‡Ø±Ø§Ø¡ Ø§Ù„Ø²ÙˆÙŠØ®",
            "Ø§Ù„Ø¬Ù‡Ø±Ø§Ø¡ Ø§Ù„ØµÙ†Ø§Ø¹ÙŠØ©",
            "Ø§Ù„Ø¬Ù‡Ø±Ø§Ø¡ Ù„ÙŠØ§Ù„ÙŠ Ø§Ù„Ø´Ø±Ù‚",
            "Ø§Ù„Ø¬Ù‡Ø±Ø§Ø¡ Ù…Ø¬Ù…Ø¹ Ù…ÙƒØ©",
            "Ø§Ù„Ø®ÙŠØ±Ø§Ù† Ø£ÙˆØªÙ„ÙŠØª Ù…ÙˆÙ„",
            "Ø§Ù„Ø®ÙŠØ±Ø§Ù† Ø£ÙˆÙŠØ§ Ù…ÙˆÙ„",
            "Ø§Ù„Ø®ÙŠÙˆÙ„",
            "Ø§Ù„Ø¯Ø³Ù…Ø© ÙˆØ¨Ù†ÙŠØ¯ Ø§Ù„Ù‚Ø§Ø±",
            "Ø§Ù„Ø±Ø­Ø§Ø¨",
            "Ø§Ù„Ø±Ù‚Ø©",
            "Ø§Ù„Ø±Ù‚Ø¹ÙŠ",
            "Ø§Ù„Ø±ÙŠ",
            "Ø§Ù„Ø³Ù†Ø¯Ø¨Ø§Ø¯",
            "Ø§Ù„Ø³ÙŠØ¯ ÙŠØ§Ø³ÙŠÙ†",
            "Ø§Ù„Ø´Ø±Ù‚",
            "Ø§Ù„Ø´Ù‡Ø¯Ø§Ø¡",
            "Ø§Ù„Ø´ÙˆÙŠØ® ÙˆØ§Ø±Ù‡",
            "Ø§Ù„ØµÙ„ÙŠØ¨ÙŠØ© Ø§Ù„ØµÙ†Ø§Ø¹ÙŠØ©",
            "Ø§Ù„Ø¶Ø¨Ø§Ø¹ÙŠØ©",
            "Ø§Ù„Ø¹Ø§Ø±Ø¶ÙŠØ© Ø§Ù„Ø¬Ø¯ÙŠØ¯",
            "Ø§Ù„ÙØ­Ø§Ø­ÙŠÙ„",
            "Ø§Ù„ÙØ±ÙˆØ§Ù†ÙŠØ© ÙØ±Ø¹ 2",
            "Ø§Ù„ÙÙ†Ø·Ø§Ø³",
            "Ø§Ù„ÙÙŠØ­Ø§Ø¡",
            "Ø§Ù„Ù‚Ø§Ø¯Ø³ÙŠØ©",
            "Ø§Ù„Ù…Ø·Ø§Ø±",
            "Ø§Ù„Ù…Ù†Ù‚Ù",
            "Ø§Ù„Ù†Ø§ÙÙˆØ±Ø©",
            "Ø§Ù„ÙˆÙØ±Ø©",
            "Ø£Ø¨Ùˆ Ø­Ù„ÙŠÙØ©",
            "Ø£Ø³ÙˆØ§Ù‚ Ø§Ù„Ù‚Ø±ÙŠÙ†",
            "Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ø²Ù‡Ø±Ø§Ø¡",
            "Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„ØµÙ„ÙŠØ¨ÙŠØ©",
            "Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ø¹Ø¯Ø§Ù† ÙˆØ§Ù„Ù‚ØµÙˆØ±",
            "Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ù‚ÙŠØ±ÙˆØ§Ù†",
            "Ø¬Ù…Ø¹ÙŠØ© Ø£Ø¨ÙˆÙØ·ÙŠØ±Ø©",
            "Ø¬Ù…Ø¹ÙŠØ© ØµØ¨Ø§Ø­ Ø§Ù„Ø§Ø­Ù…Ø¯",
            "Ø¬Ù…Ø¹ÙŠØ© Ù…Ø¯ÙŠÙ†Ø© Ø¬Ø§Ø¨Ø± Ø§Ù„Ø£Ø­Ù…Ø¯",
            "Ø­ÙˆÙ„ÙŠ Ø¨Ø§Ø±Ùƒ",
            "Ø®ÙŠØ·Ø§Ù† Ø§Ù„Ø¹ØµÙŠÙ…ÙŠ",
            "Ø³Ø¹Ø¯ Ø§Ù„Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡",
            "Ø³Ù„ÙˆÙ‰",
            "Ø³ÙˆÙ‚ Ø§Ù„Ø¬Ù„ÙŠØ¨",
            "Ø´Ø§Ø±Ø¹ Ø§Ù„Ø¨Ø­Ø±ÙŠÙ†",
            "Ø´Ø±Ù‚ Ø§Ù„Ø§Ø­Ù…Ø¯ÙŠ",
            "ØµØ¨Ø§Ø­ Ø§Ù„Ø³Ø§Ù„Ù…",
            "ØµØ¨Ø§Ø­ Ø§Ù„Ø³Ø§Ù„Ù… (Ø§Ù„Ø¹Ø±ÙŠÙ†)",
            "ØºØ±Ø¨ Ø£Ø¨Ùˆ ÙØ·ÙŠØ±Ø©",
            "ÙƒØ¨Ø¯",
            "Ù…Ø§Ø±ÙŠÙ†Ø§ Ù…ÙˆÙ„",
            "Ù…Ø¬Ù…Ø¹ Ø§Ù„ÙƒÙˆØª",
            "Ù…Ø´Ø±Ù",
            "Ù…ÙˆÙ„ 360",
            "Ù†Ø§Ø¯ÙŠ Ø§Ù„ØµÙ„ÙŠØ¨Ø®Ø§Øª",
            "Ù‡Ø¯ÙŠØ©",
            "Ø§Ù„Ø®ÙŠØ±Ø§Ù†",
            "Ø§Ù„Ø®ÙŠØ±Ø§Ù† Ø£ÙˆØªÙ„ÙŠØª",
            "Ø§Ù„Ø®ÙŠØ±Ø§Ù† Ø£ÙˆÙŠØ§"
        ];

        // Ù‡ÙŠÙƒÙ„ Ø§Ù„Ø£ØµÙ†Ø§Ù Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ø¨Ù†ÙØ³ ØªØ±ØªÙŠØ¨ Ù…Ù„Ù Collecting
        let inventoryData = [];

        // Ù…Ø¬Ù…ÙˆØ¹Ø§Øª ØªØ¬Ù…ÙŠØ¹ Ø§Ù„ÙØ±ÙˆÙ‚Ø§Øª Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©
        const groupedItems = {
            'K1035': ['K1035', 'K1036'],  // Chicken Big Fillet Ù…Ø¹ Spicy
            'K1036': ['K1035', 'K1036'],
            'K1008': ['K1008', 'K1009'],  // Chicken Fillet Ø¹Ø§Ø¯ÙŠ Ù…Ø¹ ÙÙ„ÙÙ„
            'K1009': ['K1008', 'K1009'],
            'K1015': ['K1015', 'K1016'],  // Chicken Finger Fillet Ù…Ø¹ Spicy
            'K1016': ['K1015', 'K1016'],
            'K1012': ['K1012', 'K1013'],  // Chicken Fried Ø¹Ø§Ø¯ÙŠ Ù…Ø¹ ÙÙ„ÙÙ„
            'K1013': ['K1012', 'K1013'],
            'K1039': ['K1039', 'K1040'],  // Drumstick whole Fried Ø¹Ø§Ø¯ÙŠ Ù…Ø¹ ÙÙ„ÙÙ„
            'K1040': ['K1039', 'K1040']
        };

        // Ø¹Ù†Ø§ØµØ± DOM
        const restaurantSearch = document.getElementById('restaurant-search');
        const restaurantSuggestions = document.getElementById('restaurant-suggestions');
        const inventoryDate = document.getElementById('inventory-date');
        const exportPdfBtn = document.getElementById('export-pdf');
        const clearDataBtn = document.getElementById('clear-data');
        const excelFileInput = document.getElementById('excel-file');
        const tableBody = document.getElementById('table-body');
        const currentDateEl = document.getElementById('current-date');

        // Ø¯Ø§Ù„Ø© ØªÙ‚Ø±ÙŠØ¨ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø¥Ù„Ù‰ Ø£Ù‚Ø±Ø¨ Ø±Ù‚Ù… Ø¹Ø´Ø±ÙŠ ÙˆØ§Ø­Ø¯
        function roundToDecimal(num) {
            if (num === 0 || num === 0.0 || num === '0') return 0;
            // ØªÙ‚Ø±ÙŠØ¨ Ø¥Ù„Ù‰ Ø£Ù‚Ø±Ø¨ Ø±Ù‚Ù… Ø¹Ø´Ø±ÙŠ ÙˆØ§Ø­Ø¯
            return Math.round(num * 10) / 10;
        }

        // Ø¯Ø§Ù„Ø© ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¬Ø±Ø§Ù… Ø¥Ù„Ù‰ ÙƒÙŠÙ„Ùˆ (Ù‚Ø³Ù…Ø© Ø¹Ù„Ù‰ 1000)
        function convertGramToKilo(value) {
            if (value === 0 || value === 0.0 || value === '0') return 0;
            return value / 1000;
        }

        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ø­Ø§Ù„ÙŠ Ø¨Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©
        function initializeDate() {
            const today = new Date();
            const days = ['Ø§Ù„Ø£Ø­Ø¯', 'Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†', 'Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡', 'Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡', 'Ø§Ù„Ø®Ù…ÙŠØ³', 'Ø§Ù„Ø¬Ù…Ø¹Ø©', 'Ø§Ù„Ø³Ø¨Øª'];
            const months = ['ÙŠÙ†Ø§ÙŠØ±', 'ÙØ¨Ø±Ø§ÙŠØ±', 'Ù…Ø§Ø±Ø³', 'Ø£Ø¨Ø±ÙŠÙ„', 'Ù…Ø§ÙŠÙˆ', 'ÙŠÙˆÙ†ÙŠÙˆ', 'ÙŠÙˆÙ„ÙŠÙˆ', 'Ø£ØºØ³Ø·Ø³', 'Ø³Ø¨ØªÙ…Ø¨Ø±', 'Ø£ÙƒØªÙˆØ¨Ø±', 'Ù†ÙˆÙÙ…Ø¨Ø±', 'Ø¯ÙŠØ³Ù…Ø¨Ø±'];
            
            const dayName = days[today.getDay()];
            const day = today.getDate();
            const month = months[today.getMonth()];
            const year = today.getFullYear();
            
            currentDateEl.textContent = `${dayName}ØŒ ${day} ${month} ${year}`;
            
            // ØªØ¹ÙŠÙŠÙ† ØªØ§Ø±ÙŠØ® Ø§Ù„ÙŠÙˆÙ… ÙƒØªØ§Ø±ÙŠØ® Ø§ÙØªØ±Ø§Ø¶ÙŠ Ù„Ù„Ø¬Ø±Ø¯
            const todayStr = today.toISOString().split('T')[0];
            inventoryDate.value = todayStr;
        }

        // ØªÙ‡ÙŠØ¦Ø© Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ø·Ø§Ø¹Ù…
        function initializeRestaurantSearch() {
            restaurantSearch.addEventListener('input', function() {
                const searchTerm = this.value.toLowerCase();
                restaurantSuggestions.innerHTML = '';
                
                if (searchTerm.length === 0) {
                    restaurantSuggestions.style.display = 'none';
                    return;
                }
                
                const filteredRestaurants = restaurants.filter(restaurant => 
                    restaurant.toLowerCase().includes(searchTerm)
                );
                
                if (filteredRestaurants.length > 0) {
                    filteredRestaurants.forEach(restaurant => {
                        const suggestion = document.createElement('div');
                        suggestion.className = 'search-suggestion';
                        suggestion.textContent = restaurant;
                        suggestion.addEventListener('click', function() {
                            restaurantSearch.value = restaurant;
                            restaurantSuggestions.style.display = 'none';
                        });
                        restaurantSuggestions.appendChild(suggestion);
                    });
                    restaurantSuggestions.style.display = 'block';
                } else {
                    restaurantSuggestions.style.display = 'none';
                }
            });
            
            // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬Ù‡Ø§
            document.addEventListener('click', function(event) {
                if (!restaurantSearch.contains(event.target) && !restaurantSuggestions.contains(event.target)) {
                    restaurantSuggestions.style.display = 'none';
                }
            });
            
            // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Esc
            restaurantSearch.addEventListener('keydown', function(event) {
                if (event.key === 'Escape') {
                    restaurantSuggestions.style.display = 'none';
                }
            });
        }

        // Ø¯Ø§Ù„Ø© Ù„ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… (Ø¥Ø¸Ù‡Ø§Ø± - Ù„Ù„ØµÙØ±)
        function formatNumber(num) {
            if (num === 0 || num === 0.0 || num === '0') {
                return '<span class="zero">-</span>';
            }
            // ØªÙ‚Ø±ÙŠØ¨ Ø§Ù„Ø±Ù‚Ù… Ø«Ù… Ø¹Ø±Ø¶Ù‡
            const rounded = roundToDecimal(num);
            return rounded;
        }

        // Ø­Ø³Ø§Ø¨ ØªØ¬Ù…ÙŠØ¹ Ø§Ù„ÙØ±ÙˆÙ‚Ø§Øª Ù„Ù„Ø£ØµÙ†Ø§Ù Ø§Ù„Ù…Ø­Ø¯Ø¯Ø© ÙÙ‚Ø·
        function calculateGroupedDifferences(items) {
            const groupedData = {};
            
            // ØªÙ‡ÙŠØ¦Ø© Ù…Ø¬Ù…ÙˆØ¹Ø§Øª Ø§Ù„Ø£ØµÙ†Ø§Ù Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©
            Object.keys(groupedItems).forEach(key => {
                const group = groupedItems[key];
                const groupKey = group.sort().join('-');
                if (!groupedData[groupKey]) {
                    groupedData[groupKey] = {
                        totalDifference: 0,
                        items: [],
                        codes: group,
                        groupName: groupKey
                    };
                }
            });
            
            items.forEach(item => {
                const code = item.code;
                
                // Ø§Ù„Ø¨Ø­Ø« Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ø°Ø§ Ø§Ù„ØµÙ†Ù ÙŠÙ†ØªÙ…ÙŠ Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ù…Ø­Ø¯Ø¯Ø©
                let groupKey = null;
                if (groupedItems[code]) {
                    const group = groupedItems[code];
                    groupKey = group.sort().join('-');
                }
                
                const closingBalance = item.opening + item.received + item.transferIn - item.transferOut - item.wastage - item.sales;
                const difference = item.actual - closingBalance;
                
                if (groupKey && groupedData[groupKey]) {
                    // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„ØµÙ†Ù ÙŠÙ†ØªÙ…ÙŠ Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ù…Ø­Ø¯Ø¯Ø©ØŒ Ù†Ø¬Ù…Ø¹Ù‡ Ù…Ø¹ Ù…Ø¬Ù…ÙˆØ¹ØªÙ‡
                    groupedData[groupKey].totalDifference += difference;
                    groupedData[groupKey].items.push(item);
                } else {
                    // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„ØµÙ†Ù ÙØ±Ø¯ÙŠØŒ Ù†Ù†Ø´Ø¦ Ù…Ø¬Ù…ÙˆØ¹Ø© ÙØ±Ø¯ÙŠØ© Ù„Ù‡
                    const individualKey = code;
                    if (!groupedData[individualKey]) {
                        groupedData[individualKey] = {
                            totalDifference: difference,
                            items: [item],
                            codes: [code],
                            groupName: code
                        };
                    }
                }
            });
            
            return groupedData;
        }

        // ØªØ­Ù…ÙŠÙ„ ÙˆØ¹Ø±Ø¶ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¬Ø±Ø¯ ***************************************************************
// ØªØ­Ù…ÙŠÙ„ ÙˆØ¹Ø±Ø¶ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¬Ø±Ø¯
function loadInventoryData() {
    const selectedRestaurant = restaurantSearch.value;
    const selectedDate = inventoryDate.value;
    
    if (!selectedRestaurant) {
        alert('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø·Ø¹Ù… Ø£ÙˆÙ„Ø§Ù‹');
        return;
    }
    
    if (inventoryData.length === 0) {
        alert('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ø¹Ø±Ø¶Ù‡Ø§. ÙŠØ±Ø¬Ù‰ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ù…Ù„Ù Excel Ø£ÙˆÙ„Ø§Ù‹.');
        return;
    }
    
    // Ù…Ø³Ø­ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø­Ø§Ù„ÙŠ
    tableBody.innerHTML = '';
    
    // Ø­Ø³Ø§Ø¨ Ø§Ù„ØªØ¬Ù…ÙŠØ¹Ø§Øª Ù„Ù„Ø£ØµÙ†Ø§Ù Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©
    const groupedDifferences = calculateGroupedDifferences(inventoryData);
    
    // Ø¥Ù†Ø´Ø§Ø¡ Ø®Ø±ÙŠØ·Ø© Ù„ØªØªØ¨Ø¹ Ø§Ù„ØµÙÙˆÙ Ø§Ù„Ù…Ø¯Ù…Ø¬Ø©
    const rowGroups = new Map();
    const processedCodes = new Set(); // Ù„ØªØ¬Ù†Ø¨ Ù…Ø¹Ø§Ù„Ø¬Ø© Ù†ÙØ³ Ø§Ù„ÙƒÙˆØ¯ Ù…Ø±ØªÙŠÙ†
    
    // Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰: ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ø³Ø¨ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª
    inventoryData.forEach((item) => {
        const code = item.code;
        
        // Ø¥Ø°Ø§ ØªÙ…Øª Ù…Ø¹Ø§Ù„Ø¬Ø© Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆØ¯ Ù…Ø³Ø¨Ù‚Ø§Ù‹ØŒ Ù†ØªØ®Ø·Ø§Ù‡
        if (processedCodes.has(code)) return;
        
        let groupKey = null;
        
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆØ¯ ÙŠÙ†ØªÙ…ÙŠ Ø¥Ù„Ù‰ Ù…Ø¬Ù…ÙˆØ¹Ø© Ù…Ø­Ø¯Ø¯Ø©
        if (groupedItems[code]) {
            const group = groupedItems[code];
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£ØµÙ†Ø§Ù ÙÙŠ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© ÙÙŠ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©
            const existingGroupItems = group.filter(groupCode => 
                inventoryData.some(dataItem => dataItem.code === groupCode)
            );
            
            if (existingGroupItems.length > 1) {
                // Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ Ø£ÙƒØ«Ø± Ù…Ù† ØµÙ†Ù Ù…ÙˆØ¬ÙˆØ¯ØŒ Ù†Ù†Ø´Ø¦ Ù…Ø¬Ù…ÙˆØ¹Ø©
                groupKey = existingGroupItems.sort().join('-');
                
                // ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ø£ØµÙ†Ø§Ù ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©
                const groupItems = existingGroupItems.map(groupCode => 
                    inventoryData.find(dataItem => dataItem.code === groupCode)
                ).filter(item => item); // Ø¥Ø²Ø§Ù„Ø© Ø£ÙŠ Ø¹Ù†Ø§ØµØ± undefined
                
                if (groupItems.length > 1) {
                    rowGroups.set(groupKey, groupItems);
                    
                    // ÙˆØ¶Ø¹ Ø¹Ù„Ø§Ù…Ø© Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ ÙÙŠ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© ÙƒÙ…Ø¹Ø§Ù„Ø¬Ø©
                    existingGroupItems.forEach(groupCode => {
                        processedCodes.add(groupCode);
                    });
                } else {
                    // Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ ØµÙ†Ù ÙˆØ§Ø­Ø¯ ÙÙ‚Ø·ØŒ Ù†Ø¹Ø§Ù…Ù„Ù‡ ÙƒÙØ±Ø¯ÙŠ
                    groupKey = code;
                    rowGroups.set(groupKey, [item]);
                    processedCodes.add(code);
                }
            } else {
                // Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ ØµÙ†Ù ÙˆØ§Ø­Ø¯ ÙÙ‚Ø·ØŒ Ù†Ø¹Ø§Ù…Ù„Ù‡ ÙƒÙØ±Ø¯ÙŠ
                groupKey = code;
                rowGroups.set(groupKey, [item]);
                processedCodes.add(code);
            }
        } else {
            // ØµÙ†Ù ÙØ±Ø¯ÙŠ
            groupKey = code;
            rowGroups.set(groupKey, [item]);
            processedCodes.add(code);
        }
    });
    
    // Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©: Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØµÙÙˆÙ
    rowGroups.forEach((groupItems, groupKey) => {
        const isGrouped = groupKey.includes('-') && groupItems.length > 1;
        
        // Ø­Ø³Ø§Ø¨ Ø§Ù„ÙØ±Ù‚ Ø§Ù„Ù…Ø¬Ù…Ø¹ Ù„Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©
        let groupTotalDifference = 0;
        if (isGrouped) {
            groupItems.forEach(item => {
                const closingBalance = item.opening + item.received + item.transferIn - item.transferOut - item.wastage - item.sales;
                const difference = item.actual - closingBalance;
                groupTotalDifference += difference;
            });
        }
        
        const roundedGroupDiff = roundToDecimal(groupTotalDifference);
        const groupDiffClass = roundedGroupDiff > 0 ? 'positive' : (roundedGroupDiff < 0 ? 'negative' : 'zero');
        
        // Ø¥Ù†Ø´Ø§Ø¡ ØµÙÙˆÙ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©
        groupItems.forEach((item, itemIndex) => {
            const row = document.createElement('tr');
            
            // Ø­Ø³Ø§Ø¨ Ø§Ù„Ù‚ÙŠÙ…
            const closingBalance = item.opening + item.received + item.transferIn - item.transferOut - item.wastage - item.sales;
            const difference = item.actual - closingBalance;
            const finalBalance = item.endQty || item.actual;
            const programDifference = finalBalance - closingBalance;
            
            // ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù‚ÙŠÙ… Ø¨Ø§Ù„Ø¬Ø±Ø§Ù… Ø¥Ù„Ù‰ ÙƒÙŠÙ„Ùˆ (Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„ÙˆØ­Ø¯Ø© Ø¬Ø±Ø§Ù…)
            let displayOpening = item.opening;
            let displayReceived = item.received;
            let displayTransferIn = item.transferIn;
            let displayTransferOut = item.transferOut;
            let displayWastage = item.wastage;
            let displaySales = item.sales;
            let displayClosingBalance = closingBalance;
            let displayActual = item.actual;
            let displayFinalBalance = finalBalance;
            
            // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„ÙˆØ­Ø¯Ø© Ø¬Ø±Ø§Ù…ØŒ Ù†Ù‚Ø³Ù… Ø¹Ù„Ù‰ 1000 Ù„ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ ÙƒÙŠÙ„Ùˆ
            if (item.unit === 'gram') {
                displayOpening = convertGramToKilo(item.opening);
                displayReceived = convertGramToKilo(item.received);
                displayTransferIn = convertGramToKilo(item.transferIn);
                displayTransferOut = convertGramToKilo(item.transferOut);
                displayWastage = convertGramToKilo(item.wastage);
                displaySales = convertGramToKilo(item.sales);
                displayClosingBalance = convertGramToKilo(closingBalance);
                displayActual = convertGramToKilo(item.actual);
                displayFinalBalance = convertGramToKilo(finalBalance);
            }
            
            // ØªÙ‚Ø±ÙŠØ¨ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø±Ù‚Ø§Ù…
            const roundedOpening = roundToDecimal(displayOpening);
            const roundedReceived = roundToDecimal(displayReceived);
            const roundedTransferIn = roundToDecimal(displayTransferIn);
            const roundedTransferOut = roundToDecimal(displayTransferOut);
            const roundedWastage = roundToDecimal(displayWastage);
            const roundedSales = roundToDecimal(displaySales);
            const roundedClosingBalance = roundToDecimal(displayClosingBalance);
            const roundedActual = roundToDecimal(displayActual);
            const roundedDifference = roundToDecimal(difference);
            const roundedFinalBalance = roundToDecimal(displayFinalBalance);
            const roundedProgramDifference = roundToDecimal(programDifference);
            
            // ØªØ­Ø¯ÙŠØ¯ ÙØ¦Ø© Ø§Ù„Ø£Ø±Ù‚Ø§Ù…
            const openingClass = roundedOpening > 0 ? '' : 'zero';
            const receivedClass = roundedReceived > 0 ? '' : 'zero';
            const transferInClass = roundedTransferIn > 0 ? '' : 'zero';
            const transferOutClass = roundedTransferOut > 0 ? 'deduction' : 'zero';
            const wastageClass = roundedWastage > 0 ? 'deduction' : 'zero';
            const salesClass = roundedSales > 0 ? 'deduction' : 'zero';
            const closingClass = roundedClosingBalance > 0 ? '' : 'zero';
            const actualClass = roundedActual > 0 ? '' : 'zero';
            const endQtyClass = roundedFinalBalance > 0 ? '' : 'zero';
            const diffClass = roundedDifference > 0 ? 'positive' : (roundedDifference < 0 ? 'negative' : 'zero');
            const programDiffClass = roundedProgramDifference > 0 ? 'positive' : (roundedProgramDifference < 0 ? 'negative' : 'zero');
            
            // Ø¨Ù†Ø§Ø¡ HTML Ù„Ù„ØµÙ - Ø§Ù„Ø¹Ù…ÙˆØ¯ 1-12
            let rowHtml = `
                <td><strong>${item.code}</strong></td>
                <td class="item-name">${item.name}</td>
                <td class="${openingClass}">${formatNumber(roundedOpening)}</td>
                <td>${item.unit === 'gram' ? 'kilo' : item.unit}</td>
                <td class="${receivedClass}">${formatNumber(roundedReceived)}</td>
                <td class="${transferInClass}">${formatNumber(roundedTransferIn)}</td>
                <td class="${transferOutClass}">${formatNumber(roundedTransferOut)}</td>
                <td class="${wastageClass}">${formatNumber(roundedWastage)}</td>
                <td class="${salesClass}">${formatNumber(roundedSales)}</td>
                <td class="${closingClass}">${formatNumber(roundedClosingBalance)}</td>
                <td class="${actualClass}">${formatNumber(roundedActual)}</td>
                <td class="${diffClass}">${roundedDifference > 0 ? '+' : ''}${formatNumber(roundedDifference)}</td>
            `;
            
            // Ø¥Ø¶Ø§ÙØ© Ø®Ù„ÙŠØ© ØªØ¬Ù…ÙŠØ¹ Ø§Ù„ÙØ±ÙˆÙ‚Ø§Øª (Ø§Ù„Ø¹Ù…ÙˆØ¯ 13)
            if (itemIndex === 0) {
                if (isGrouped) {
                    // Ø£ÙˆÙ„ ØµÙ ÙÙŠ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ù…Ø¯Ù…Ø¬Ø© - Ù†Ø³ØªØ®Ø¯Ù… rowspan
                    rowHtml += `
                        <td class="grouped-difference ${groupDiffClass}" rowspan="${groupItems.length}">
                            ${roundedGroupDiff > 0 ? '+' : ''}${roundedGroupDiff !== 0 ? roundedGroupDiff : '-'}
                        </td>
                    `;
                } else {
                    // ØµÙ†Ù ÙØ±Ø¯ÙŠ
                    const individualDiff = roundedDifference;
                    const individualDiffClass = individualDiff > 0 ? 'positive' : (individualDiff < 0 ? 'negative' : 'zero');
                    rowHtml += `
                        <td class="grouped-difference ${individualDiffClass}">
                            ${individualDiff > 0 ? '+' : ''}${individualDiff !== 0 ? individualDiff : '-'}
                        </td>
                    `;
                }
            } else {
                // ØµÙÙˆÙ Ù„Ø§Ø­Ù‚Ø© ÙÙŠ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ù…Ø¯Ù…Ø¬Ø© - Ù„Ø§ Ù†Ø¶ÙŠÙ Ø´ÙŠØ¦Ø§Ù‹ Ù„Ø£Ù† Ø§Ù„Ø®Ù„ÙŠØ© Ù…ØºØ·Ø§Ø© Ø¨ÙˆØ§Ø³Ø·Ø© rowspan
                // Ù„Ø§ Ù†Ø¶ÙŠÙ <td> Ù‡Ù†Ø§!
            }
            
            // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¹Ù…ÙˆØ¯ÙŠÙ† Ø§Ù„Ø£Ø®ÙŠØ±ÙŠÙ† (14 Ùˆ 15)
            rowHtml += `
                <td class="${endQtyClass}">${formatNumber(roundedFinalBalance)}</td>
                <td class="${programDiffClass}">${roundedProgramDifference > 0 ? '+' : ''}${formatNumber(roundedProgramDifference)}</td>
            `;
            
            row.innerHTML = rowHtml;
            tableBody.appendChild(row);
        });
    });
}
        // Ù‚Ø±Ø§Ø¡Ø© Ù…Ù„Ù Excel ÙˆØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ***************************************************************
        function handleExcelFile(file) {
            const reader = new FileReader();
            
            reader.onload = function(e) {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });
                    
                    // Ø£ÙˆÙ„Ø§Ù‹: Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø£ØµÙ†Ø§Ù Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ù…Ù† Ø´ÙŠØª Ø§Ù„Ø¬Ø±Ø¯ Ø§Ù„ÙØ¹Ù„ÙŠ
                    const baseItems = readBaseItemsFromActualInventory(workbook);
                    
                    // Ø«Ø§Ù†ÙŠØ§Ù‹: Ø¬Ù…Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø´ÙŠØªØ§Øª Ù„Ù„Ø£ØµÙ†Ø§Ù Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© ÙÙ‚Ø·
                    const parsedData = parseAllSheetsForBaseItems(workbook, baseItems);
                    
                    if (parsedData.length > 0) {
                        inventoryData = parsedData;
                        loadInventoryData();
                        // ØªÙ… Ø¥Ø²Ø§Ù„Ø© Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ ÙƒÙ…Ø§ Ø·Ù„Ø¨Øª
                    } else {
                        alert('Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ù…Ù„Ù Excel. ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ù…Ù„Ù.');
                    }
                } catch (error) {
                    console.error('Error reading Excel file:', error);
                    alert('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© Ù…Ù„Ù Excel. ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ù…Ù„Ù.');
                }
            };
            
            reader.readAsArrayBuffer(file);
        }

        // Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø£ØµÙ†Ø§Ù Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ù…Ù† Ø´ÙŠØª Ø§Ù„Ø¬Ø±Ø¯ Ø§Ù„ÙØ¹Ù„ÙŠ
        function readBaseItemsFromActualInventory(workbook) {
            const baseItems = [];
            
            // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø´ÙŠØª Ø§Ù„Ø¬Ø±Ø¯ Ø§Ù„ÙØ¹Ù„ÙŠ
            const sheetNames = workbook.SheetNames;
            let actualSheetName = '';
            
            for (const name of sheetNames) {
                if (name.includes('ÙØ¹Ù„ÙŠ') || name.includes('Ø§Ù„Ø¬Ø±Ø¯ Ø§Ù„ÙØ¹Ù„ÙŠ') || name.includes('Ø§Ù„ÙØ¹Ù„ÙŠ')) {
                    actualSheetName = name;
                    break;
                }
            }
            
            if (!actualSheetName) {
                actualSheetName = sheetNames.find(name => name.includes('Ø¬Ø±Ø¯')) || sheetNames[0];
            }
            
            const worksheet = workbook.Sheets[actualSheetName];
            const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, defval: '' });
            
            // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† ØµÙ Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ†
            let headerRowIndex = -1;
            for (let i = 0; i < jsonData.length; i++) {
                const row = jsonData[i];
                if (row && row.length >= 2) {
                    if (row[0] && (row[0].toString().includes('Ø§Ù„ÙƒÙˆØ¯') || row[0].toString().includes('Code'))) {
                        headerRowIndex = i;
                        break;
                    }
                }
            }
            
            if (headerRowIndex === -1) headerRowIndex = 0;
            
            // Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø£ØµÙ†Ø§Ù Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
            for (let i = headerRowIndex + 1; i < jsonData.length; i++) {
                const row = jsonData[i];
                if (row && row.length >= 4) {
                    const code = String(row[0] || '').trim();
                    const name = String(row[1] || '').trim();
                    
                    if (code && (code.startsWith('K') || code.startsWith('A') || code.startsWith('L'))) {
                        // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ÙˆØ­Ø¯Ø© Ø§Ù„Ø®Ø§ØµØ© Ù„Ù„ØµÙ†Ù K1070
                        let unit = determineUnitFromRow(row);
                        if (code === 'K1070') {
                            unit = 'kilo'; // Fresh Burger Chickens ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† Ø¨Ø§Ù„ÙƒÙŠÙ„Ùˆ
                        }
                        
                        baseItems.push({
                            code: code,
                            name: name,
                            unit: unit
                        });
                    }
                }
            }
            
            return baseItems;
        }

        // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ÙˆØ­Ø¯Ø© Ù…Ù† Ø§Ù„ØµÙ
        function determineUnitFromRow(row) {
            if (row.length >= 3) {
                const unitText = String(row[2] || '').toLowerCase();
                return determineUnit(unitText);
            }
            return 'pc';
        }

        // Ø¬Ù…Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø´ÙŠØªØ§Øª Ù„Ù„Ø£ØµÙ†Ø§Ù Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© ÙÙ‚Ø·
        function parseAllSheetsForBaseItems(workbook, baseItems) {
            // Ø¥Ù†Ø´Ø§Ø¡ Ù‡ÙŠÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ
            const parsedData = baseItems.map(item => ({
                code: item.code,
                name: item.name,
                unit: item.unit,
                opening: 0,
                received: 0,
                transferIn: 0,
                transferOut: 0,
                wastage: 0,
                sales: 0,
                actual: 0,
                endQty: 0
            }));
            
            // ØªØ­Ù„ÙŠÙ„ ÙƒÙ„ Ø´ÙŠØª
            workbook.SheetNames.forEach(sheetName => {
                const worksheet = workbook.Sheets[sheetName];
                const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, defval: '' });
                
                if (sheetName.includes('Ø±ØµÙŠØ¯ Ø£ÙˆÙ„') || sheetName.includes('Ø§ÙˆÙ„ Ø§Ù„ÙŠÙˆÙ…') || 
                    sheetName.includes('Start Balance') || sheetName.includes('Start')) {
                    parseOpeningBalanceForBaseItems(jsonData, parsedData);
                } else if (sheetName.includes('Ø±ØµÙŠØ¯ Ø¢Ø®Ø±') || sheetName.includes('Ø§Ø®Ø± Ø§Ù„ÙŠÙˆÙ…') || 
                          sheetName.includes('End Balance') || sheetName.includes('End')) {
                    parseEndingBalanceForBaseItems(jsonData, parsedData);
                } else if (sheetName.includes('Ø§Ø³ØªÙ„Ø§Ù…')) {
                    parseReceiptsForBaseItems(jsonData, parsedData);
                } else if (sheetName.includes('Ù…Ø¨ÙŠØ¹Ø§Øª')) {
                    parseSalesForBaseItems(jsonData, parsedData);
                } else if (sheetName.includes('ÙØ¹Ù„ÙŠ') || sheetName.includes('Ø§Ù„Ø¬Ø±Ø¯ Ø§Ù„ÙØ¹Ù„ÙŠ')) {
                    parseActualInventoryForBaseItems(jsonData, parsedData);
                } else if (sheetName.includes('ØªÙˆØ§Ù„Ù')) {
                    parseWastageForBaseItems(jsonData, parsedData);
                } else if (sheetName.includes('ØªØ­ÙˆÙŠÙ„')) {
                    parseTransfersForBaseItems(jsonData, parsedData, sheetName);
                }
            });
            
            return parsedData;
        }

        // ØªØ­ÙˆÙŠÙ„ Ø§Ù„ÙƒÙ…ÙŠØ© Ù…Ù† Ø§Ù„ÙˆØ­Ø¯Ø© Ø§Ù„ÙƒØ¨Ø±Ù‰ Ø¥Ù„Ù‰ Ø§Ù„ÙˆØ­Ø¯Ø© Ø§Ù„ØµØºØ±Ù‰
        function convertToSmallestUnit(quantity, unitText, itemCode) {
            if (!quantity || quantity === 0) return 0;
            
            // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„ØµÙ†Ù K1070ØŒ Ù„Ø§ Ù†Ø­ÙˆÙ„ Ø¥Ù„Ù‰ Ø¬Ø±Ø§Ù… Ø¨Ù„ Ù†Ø¨Ù‚ÙŠÙ‡ Ø¨Ø§Ù„ÙƒÙŠÙ„Ùˆ
            if (itemCode === 'K1070') {
                return quantity; // Ù†Ø¨Ù‚ÙŠÙ‡ Ø¨Ø§Ù„ÙƒÙŠÙ„Ùˆ ÙƒÙ…Ø§ Ù‡Ùˆ
            }
            
            const unit = unitText.toLowerCase();
            
            // ØªØ­ÙˆÙŠÙ„ Ù…Ù† Ø¨Ø§ÙƒÙŠØª Ø¥Ù„Ù‰ Ù‚Ø·Ø¹
            if (unit.includes('packet') || unit.includes('Ø¨Ø§ÙƒÙŠØª')) {
                if (unit.includes('10')) return quantity * 10;
                if (unit.includes('20')) return quantity * 20;
                if (unit.includes('25')) return quantity * 25;
                if (unit.includes('18')) return quantity * 18;
                if (unit.includes('60')) return quantity * 60;
                if (unit.includes('5')) return quantity * 5;
                if (unit.includes('8')) return quantity * 8;
                if (unit.includes('9')) return quantity * 9;
                if (unit.includes('12')) return quantity * 12;
                if (unit.includes('40')) return quantity * 40;
                if (unit.includes('120')) return quantity * 120;
                if (unit.includes('50')) return quantity * 50;
            }
            
            // ØªØ­ÙˆÙŠÙ„ Ù…Ù† ÙƒØ±ØªÙˆÙ† Ø¥Ù„Ù‰ Ù‚Ø·Ø¹
            if (unit.includes('carton') || unit.includes('ÙƒØ±ØªÙˆÙ†')) {
                if (unit.includes('12')) return quantity * 12;
                if (unit.includes('40')) return quantity * 40;
            }
            
            // ØªØ­ÙˆÙŠÙ„ Ù…Ù† ÙƒÙŠÙ„Ùˆ Ø¥Ù„Ù‰ Ø¬Ø±Ø§Ù… (Ù„ÙƒÙ† Ù„ÙŠØ³ Ù„Ù€ K1070)
            if (unit.includes('kilo') || unit.includes('ÙƒÙŠÙ„Ùˆ') || unit.includes('kg')) {
                return quantity * 1000;
            }
            
            // ØªØ­ÙˆÙŠÙ„ Ù…Ù† Ø¨Ø§ÙƒÙŠØª Ø¨Ø§Ù„ÙƒÙŠÙ„Ùˆ Ø¥Ù„Ù‰ Ø¬Ø±Ø§Ù…
            if (unit.includes('packet') && unit.includes('kg')) {
                const kgMatch = unit.match(/(\d+\.?\d*)\s*kg/i);
                if (kgMatch) {
                    const kgPerPacket = parseFloat(kgMatch[1]);
                    return quantity * kgPerPacket * 1000;
                }
            }
            
            return quantity;
        }

        // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ÙˆØ­Ø¯Ø© Ø§Ù„ØµØºØ±Ù‰
        function determineUnit(unitText) {
            const unit = unitText.toLowerCase();
            
            if (unit.includes('ÙƒÙŠÙ„Ùˆ') || unit.includes('kilo') || unit.includes('kg')) {
                return 'gram';
            } else if (unit.includes('Ø¨Ø§ÙƒÙŠØª') || unit.includes('packet') || unit.includes('pkt')) {
                return 'pc';
            } else if (unit.includes('ÙƒØ±ØªÙˆÙ†') || unit.includes('carton') || unit.includes('ctn')) {
                return 'pc';
            } else if (unit.includes('Ø¬Ø±Ø§Ù…') || unit.includes('gram') || unit.includes('gm')) {
                return 'gram';
            } else if (unit.includes('Ù‚Ø·Ø¹Ø©') || unit.includes('piece') || unit.includes('pc') || unit.includes('pcs')) {
                return 'pc';
            }
            
            return 'pc';
        }

        // ØªØ­Ù„ÙŠÙ„ Ø´ÙŠØª Ø±ØµÙŠØ¯ Ø£ÙˆÙ„ Ù„Ù„Ø£ØµÙ†Ø§Ù Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© - Ù…Ù† Start Balance ÙˆØ¹Ù…ÙˆØ¯ Start Qty
        function parseOpeningBalanceForBaseItems(data, parsedData) {
            console.log("ØªØ­Ù„ÙŠÙ„ Ø±ØµÙŠØ¯ Ø£ÙˆÙ„ Ù…Ù† Start Balance");
            
            // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† ØµÙ Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ†
            let headerRowIndex = -1;
            for (let i = 0; i < data.length; i++) {
                const row = data[i];
                if (row && row.length >= 15) {
                    // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø£ÙŠ Ø¹Ù…ÙˆØ¯ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ RM Code
                    for (let j = 0; j < row.length; j++) {
                        if (row[j] && row[j].toString().includes('RM Code')) {
                            headerRowIndex = i;
                            break;
                        }
                    }
                    if (headerRowIndex !== -1) break;
                }
            }
            
            if (headerRowIndex === -1) {
                console.log("Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¹Ù†Ø§ÙˆÙŠÙ† ÙÙŠ Start Balance");
                return;
            }
            
            // ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆØ§Ù‚Ø¹ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø©
            const headerRow = data[headerRowIndex];
            let rmCodeCol = -1;
            let startQtyCol = -1;
            let vendorUOMCol = -1;
            
            for (let j = 0; j < headerRow.length; j++) {
                const cell = headerRow[j];
                if (cell) {
                    const cellText = cell.toString().toLowerCase();
                    if (cellText.includes('rm code')) {
                        rmCodeCol = j;
                    } else if (cellText.includes('start qty') || cellText.includes('Ø±ØµÙŠØ¯ Ø£ÙˆÙ„')) {
                        startQtyCol = j;
                    } else if (cellText.includes('vendoruom') || cellText.includes('Ø§Ù„ÙˆØ­Ø¯Ø©')) {
                        vendorUOMCol = j;
                    }
                }
            }
            
            console.log("Ù…ÙˆØ§Ù‚Ø¹ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø©:", { rmCodeCol, startQtyCol, vendorUOMCol });
            
            // Ø¥Ø°Ø§ Ù„Ù… Ù†Ø¬Ø¯ Ø¹Ù…ÙˆØ¯ Start QtyØŒ Ù†Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©
            if (startQtyCol === -1) {
                // ÙÙŠ Ù…Ù„Ù Excel Ø§Ù„Ù…Ø±ÙÙ‚ØŒ Start Qty Ù‡Ùˆ Ø§Ù„Ø¹Ù…ÙˆØ¯ 14 (P)
                startQtyCol = 14;
            }
            
            if (vendorUOMCol === -1) {
                // VendorUOM Ù‡Ùˆ Ø§Ù„Ø¹Ù…ÙˆØ¯ 7 (H)
                vendorUOMCol = 7;
            }
            
            // ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            let itemCount = 0;
            for (let i = headerRowIndex + 1; i < data.length; i++) {
                const row = data[i];
                if (row && row.length > Math.max(rmCodeCol, startQtyCol)) {
                    const code = String(row[rmCodeCol] || '').trim();
                    const stockQty = parseFloat(row[startQtyCol]) || 0;
                    const unitText = vendorUOMCol !== -1 && row[vendorUOMCol] ? 
                        String(row[vendorUOMCol] || '').trim() : '';
                    
                    if (code && (code.startsWith('K') || code.startsWith('A') || code.startsWith('L'))) {
                        const item = parsedData.find(item => item.code === code);
                        if (item) {
                            const convertedQty = convertToSmallestUnit(stockQty, unitText, code);
                            item.opening = convertedQty;
                            itemCount++;
                            console.log(`Ø±ØµÙŠØ¯ Ø£ÙˆÙ„: ${code} = ${stockQty} ${unitText} -> ${convertedQty} ${item.unit}`);
                        }
                    }
                }
            }
            
            console.log(`ØªÙ… ØªØ­Ù„ÙŠÙ„ ${itemCount} ØµÙ†Ù Ù„Ø±ØµÙŠØ¯ Ø£ÙˆÙ„`);
        }

        // ØªØ­Ù„ÙŠÙ„ Ø´ÙŠØª Ø±ØµÙŠØ¯ Ø¢Ø®Ø± Ù„Ù„Ø£ØµÙ†Ø§Ù Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© - Ù…Ù† End Balance ÙˆØ¹Ù…ÙˆØ¯ Start Qty
        function parseEndingBalanceForBaseItems(data, parsedData) {
            console.log("ØªØ­Ù„ÙŠÙ„ Ø±ØµÙŠØ¯ Ø¢Ø®Ø± Ù…Ù† End Balance");
            
            // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† ØµÙ Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ†
            let headerRowIndex = -1;
            for (let i = 0; i < data.length; i++) {
                const row = data[i];
                if (row && row.length >= 15) {
                    // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø£ÙŠ Ø¹Ù…ÙˆØ¯ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ RM Code
                    for (let j = 0; j < row.length; j++) {
                        if (row[j] && row[j].toString().includes('RM Code')) {
                            headerRowIndex = i;
                            break;
                        }
                    }
                    if (headerRowIndex !== -1) break;
                }
            }
            
            if (headerRowIndex === -1) {
                console.log("Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¹Ù†Ø§ÙˆÙŠÙ† ÙÙŠ End Balance");
                return;
            }
            
            // ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆØ§Ù‚Ø¹ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø©
            const headerRow = data[headerRowIndex];
            let rmCodeCol = -1;
            let startQtyCol = -1;
            let vendorUOMCol = -1;
            
            for (let j = 0; j < headerRow.length; j++) {
                const cell = headerRow[j];
                if (cell) {
                    const cellText = cell.toString().toLowerCase();
                    if (cellText.includes('rm code')) {
                        rmCodeCol = j;
                    } else if (cellText.includes('start qty') || cellText.includes('Ø±ØµÙŠØ¯ Ø£ÙˆÙ„')) {
                        startQtyCol = j;
                    } else if (cellText.includes('vendoruom') || cellText.includes('Ø§Ù„ÙˆØ­Ø¯Ø©')) {
                        vendorUOMCol = j;
                    }
                }
            }
            
            console.log("Ù…ÙˆØ§Ù‚Ø¹ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© End Balance:", { rmCodeCol, startQtyCol, vendorUOMCol });
            
            // Ø¥Ø°Ø§ Ù„Ù… Ù†Ø¬Ø¯ Ø¹Ù…ÙˆØ¯ Start QtyØŒ Ù†Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©
            if (startQtyCol === -1) {
                // ÙÙŠ Ù…Ù„Ù Excel Ø§Ù„Ù…Ø±ÙÙ‚ØŒ Start Qty Ù‡Ùˆ Ø§Ù„Ø¹Ù…ÙˆØ¯ 14 (P)
                startQtyCol = 14;
            }
            
            if (vendorUOMCol === -1) {
                vendorUOMCol = 7;
            }
            
            // ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            let itemCount = 0;
            for (let i = headerRowIndex + 1; i < data.length; i++) {
                const row = data[i];
                if (row && row.length > Math.max(rmCodeCol, startQtyCol)) {
                    const code = String(row[rmCodeCol] || '').trim();
                    const endQty = parseFloat(row[startQtyCol]) || 0;
                    const unitText = vendorUOMCol !== -1 && row[vendorUOMCol] ? 
                        String(row[vendorUOMCol] || '').trim() : '';
                    
                    if (code && (code.startsWith('K') || code.startsWith('A') || code.startsWith('L'))) {
                        const item = parsedData.find(item => item.code === code);
                        if (item) {
                            // ØªØ­ÙˆÙŠÙ„ Ø±ØµÙŠØ¯ Ø¢Ø®Ø± Ø¥Ù„Ù‰ Ø§Ù„ÙˆØ­Ø¯Ø© Ø§Ù„Ø£ØµØºØ±
                            const convertedEndQty = convertToSmallestUnit(endQty, unitText, code);
                            item.endQty = convertedEndQty;
                            itemCount++;
                            console.log(`Ø±ØµÙŠØ¯ Ø¢Ø®Ø±: ${code} = ${endQty} ${unitText} -> ${convertedEndQty} ${item.unit}`);
                        }
                    }
                }
            }
            
            console.log(`ØªÙ… ØªØ­Ù„ÙŠÙ„ ${itemCount} ØµÙ†Ù Ù„Ø±ØµÙŠØ¯ Ø¢Ø®Ø±`);
        }

        // ØªØ­Ù„ÙŠÙ„ Ø´ÙŠØª Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…Ø§Øª Ù„Ù„Ø£ØµÙ†Ø§Ù Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
        function parseReceiptsForBaseItems(data, parsedData) {
            console.log("ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…Ø§Øª");
            
            // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† ØµÙ Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ†
            let headerRowIndex = -1;
            for (let i = 0; i < data.length; i++) {
                const row = data[i];
                if (row && row.length >= 6) {
                    if (row[2] && row[2].toString().includes('RM Code')) {
                        headerRowIndex = i;
                        break;
                    }
                }
            }
            
            if (headerRowIndex === -1) {
                console.log("Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¹Ù†Ø§ÙˆÙŠÙ† ÙÙŠ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…Ø§Øª");
                return;
            }
            
            // ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            let itemCount = 0;
            for (let i = headerRowIndex + 1; i < data.length; i++) {
                const row = data[i];
                if (row && row.length >= 6) {
                    const code = String(row[2] || '').trim();
                    const quantity = parseFloat(row[5]) || 0;
                    const unitText = String(row[4] || '').trim();
                    
                    if (code) {
                        const item = parsedData.find(item => item.code === code);
                        if (item) {
                            const convertedQty = convertToSmallestUnit(quantity, unitText, code);
                            item.received += convertedQty;
                            itemCount++;
                            console.log(`Ø§Ø³ØªÙ„Ø§Ù…: ${code} = ${quantity} ${unitText} -> ${convertedQty} ${item.unit}`);
                        }
                    }
                }
            }
            
            console.log(`ØªÙ… ØªØ­Ù„ÙŠÙ„ ${itemCount} ØµÙ†Ù Ù„Ù„Ø§Ø³ØªÙ„Ø§Ù…Ø§Øª`);
        }

        // ØªØ­Ù„ÙŠÙ„ Ø´ÙŠØª Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª Ù„Ù„Ø£ØµÙ†Ø§Ù Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© (Ù…Ø¹ Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ø®Ù„Ø§ÙŠØ§ Ø§Ù„Ù…Ø¯Ù…Ø¬Ø©)*********************************
// ØªØ­Ù„ÙŠÙ„ Ø´ÙŠØª Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª Ù„Ù„Ø£ØµÙ†Ø§Ù Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© (Ù…Ø¹ Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ø®Ù„Ø§ÙŠØ§ Ø§Ù„Ù…Ø¯Ù…Ø¬Ø©)
function parseSalesForBaseItems(data, parsedData) {
    console.log("ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª");
    
    // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† ØµÙ Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ†
    let headerRowIndex = -1;
    for (let i = 0; i < data.length; i++) {
        const row = data[i];
        if (row && row.length >= 16) {
            const hasItemQty = row[7] && row[7].toString().includes('Item Qty');
            const hasRmName = row[10] && (row[10].toString().includes('RMName') || row[10].toString().includes('RM Name'));
            const hasDefinedQty = row[14] && row[14].toString().includes('Defined Qty');
            const hasTotalUsage = row[15] && row[15].toString().includes('Total Usage Qty');
            
            if (hasItemQty || hasRmName || hasDefinedQty || hasTotalUsage) {
                headerRowIndex = i;
                break;
            }
        }
    }
    
    if (headerRowIndex === -1) {
        for (let i = 0; i < data.length; i++) {
            const row = data[i];
            if (row && row.length >= 3 && row[2] && row[2].toString().includes('Order No')) {
                headerRowIndex = i;
                break;
            }
        }
    }
    
    if (headerRowIndex === -1) {
        console.log("Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¹Ù†Ø§ÙˆÙŠÙ† ÙÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª");
        return;
    }
    
    // ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª Ø­Ø³Ø¨ Ø§Ù„ØµÙ†Ù
    const salesMap = {};
    
    let lastItemQty = 0;
    let itemCount = 0;
    
    for (let i = headerRowIndex + 1; i < data.length; i++) {
        const row = data[i];
        if (row && row.length >= 16) {
            const rmName = String(row[10] || '').trim();
            
            let itemQty = 0;
            if (row[7] !== undefined && row[7] !== null && row[7] !== '') {
                itemQty = parseFloat(row[7]) || 0;
                if (itemQty > 0) {
                    lastItemQty = itemQty;
                }
            } else if (lastItemQty > 0) {
                itemQty = lastItemQty;
            }
            
            const definedQty = parseFloat(row[14]) || 0;
            const totalUsageQty = parseFloat(row[15]) || 0;
            const unitText = String(row[11] || '').trim();
            
            let usageQty = 0;
            if (totalUsageQty > 0) {
                usageQty = totalUsageQty;
            } else if (itemQty > 0 && definedQty > 0) {
                usageQty = itemQty * definedQty;
            } else if (itemQty > 0 && definedQty === 0) {
                usageQty = itemQty;
            }
            
            if (rmName && usageQty > 0) {
                const codeMatch = rmName.match(/([KAL]\d+)/);
                if (codeMatch) {
                    const code = codeMatch[0];
                    let convertedQty = convertToSmallestUnit(usageQty, unitText, code);
                    
                    // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø®Ø§ØµØ© Ù„Ù„ØµÙ†Ù K1070
                    if (code === 'K1070') {
                        // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ù‚ÙŠÙ…Ø© Ø¨Ø§Ù„Ø¬Ø±Ø§Ù…ØŒ Ù†Ù‚Ø³Ù…Ù‡Ø§ Ø¹Ù„Ù‰ 1000 Ù„ØªØ­ÙˆÙŠÙ„Ù‡Ø§ Ø¥Ù„Ù‰ ÙƒÙŠÙ„Ùˆ
                        const unit = unitText.toLowerCase();
                        if (unit.includes('Ø¬Ø±Ø§Ù…') || unit.includes('gram') || unit.includes('gm')) {
                            convertedQty = convertedQty / 1000;
                        }
                        // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ù‚ÙŠÙ…Ø© Ø¨Ø§Ù„Ù‚Ø·Ø¹ ÙˆÙ†Ø­ØªØ§Ø¬ ØªØ­ÙˆÙŠÙ„Ù‡Ø§ Ù…Ù† Ù‚Ø·Ø¹ Ø¥Ù„Ù‰ ÙƒÙŠÙ„Ùˆ
                        // Ø§ÙØªØ±Ø§Ø¶: ÙƒÙ„ Ù‚Ø·Ø¹Ø© = 0.18 ÙƒÙŠÙ„Ùˆ ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹
                        else if (unit.includes('Ù‚Ø·Ø¹Ø©') || unit.includes('piece') || unit.includes('pc') || unit.includes('pcs')) {
                            convertedQty = (convertedQty * 0.18) / 1000; // ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ ÙƒÙŠÙ„Ùˆ
                        }
                        // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ù‚ÙŠÙ…Ø© Ø¨Ø§Ù„Ø¨Ø§ÙƒÙŠØª
                        else if (unit.includes('Ø¨Ø§ÙƒÙŠØª') || unit.includes('packet')) {
                            // ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¨Ø§ÙƒÙŠØª Ø¥Ù„Ù‰ Ù‚Ø·Ø¹ Ø«Ù… Ø¥Ù„Ù‰ ÙƒÙŠÙ„Ùˆ
                            const packetSize = 12; // Ø§ÙØªØ±Ø§Ø¶: Ø¨Ø§ÙƒÙŠØª ÙÙŠÙ‡ 12 Ù‚Ø·Ø¹Ø©
                            convertedQty = (convertedQty * packetSize * 0.18) / 1000; // ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ ÙƒÙŠÙ„Ùˆ
                        }
                        // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ù‚ÙŠÙ…Ø© Ø¨Ø§Ù„ÙƒØ±ØªÙˆÙ†
                        else if (unit.includes('ÙƒØ±ØªÙˆÙ†') || unit.includes('carton')) {
                            // ØªØ­ÙˆÙŠÙ„ Ø§Ù„ÙƒØ±ØªÙˆÙ† Ø¥Ù„Ù‰ Ù‚Ø·Ø¹ Ø«Ù… Ø¥Ù„Ù‰ ÙƒÙŠÙ„Ùˆ
                            const cartonSize = 40; // Ø§ÙØªØ±Ø§Ø¶: ÙƒØ±ØªÙˆÙ† ÙÙŠÙ‡ 40 Ù‚Ø·Ø¹Ø©
                            convertedQty = (convertedQty * cartonSize * 0.18) / 1000; // ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ ÙƒÙŠÙ„Ùˆ
                        }
                    }
                    
                    salesMap[code] = (salesMap[code] || 0) + convertedQty;
                    itemCount++;
                    console.log(`Ù…Ø¨ÙŠØ¹Ø§Øª: ${code} = ${usageQty} ${unitText} -> ${convertedQty}`);
                } else {
                    const item = parsedData.find(item => 
                        item.name && rmName &&
                        (item.name.toLowerCase().includes(rmName.toLowerCase()) ||
                         rmName.toLowerCase().includes(item.name.toLowerCase()))
                    );
                    if (item) {
                        let convertedQty = convertToSmallestUnit(usageQty, unitText, item.code);
                        
                        // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø®Ø§ØµØ© Ù„Ù„ØµÙ†Ù K1070
                        if (item.code === 'K1070') {
                            // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ù‚ÙŠÙ…Ø© Ø¨Ø§Ù„Ø¬Ø±Ø§Ù…ØŒ Ù†Ù‚Ø³Ù…Ù‡Ø§ Ø¹Ù„Ù‰ 1000 Ù„ØªØ­ÙˆÙŠÙ„Ù‡Ø§ Ø¥Ù„Ù‰ ÙƒÙŠÙ„Ùˆ
                            const unit = unitText.toLowerCase();
                            if (unit.includes('Ø¬Ø±Ø§Ù…') || unit.includes('gram') || unit.includes('gm')) {
                                convertedQty = convertedQty / 1000;
                            }
                            // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ù‚ÙŠÙ…Ø© Ø¨Ø§Ù„Ù‚Ø·Ø¹ ÙˆÙ†Ø­ØªØ§Ø¬ ØªØ­ÙˆÙŠÙ„Ù‡Ø§ Ù…Ù† Ù‚Ø·Ø¹ Ø¥Ù„Ù‰ ÙƒÙŠÙ„Ùˆ
                            else if (unit.includes('Ù‚Ø·Ø¹Ø©') || unit.includes('piece') || unit.includes('pc') || unit.includes('pcs')) {
                                convertedQty = (convertedQty * 0.18) / 1000; // ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ ÙƒÙŠÙ„Ùˆ
                            }
                            // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ù‚ÙŠÙ…Ø© Ø¨Ø§Ù„Ø¨Ø§ÙƒÙŠØª
                            else if (unit.includes('Ø¨Ø§ÙƒÙŠØª') || unit.includes('packet')) {
                                const packetSize = 12; // Ø§ÙØªØ±Ø§Ø¶: Ø¨Ø§ÙƒÙŠØª ÙÙŠÙ‡ 12 Ù‚Ø·Ø¹Ø©
                                convertedQty = (convertedQty * packetSize * 0.18) / 1000; // ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ ÙƒÙŠÙ„Ùˆ
                            }
                            // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ù‚ÙŠÙ…Ø© Ø¨Ø§Ù„ÙƒØ±ØªÙˆÙ†
                            else if (unit.includes('ÙƒØ±ØªÙˆÙ†') || unit.includes('carton')) {
                                const cartonSize = 40; // Ø§ÙØªØ±Ø§Ø¶: ÙƒØ±ØªÙˆÙ† ÙÙŠÙ‡ 40 Ù‚Ø·Ø¹Ø©
                                convertedQty = (convertedQty * cartonSize * 0.18) / 1000; // ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ ÙƒÙŠÙ„Ùˆ
                            }
                        }
                        
                        salesMap[item.code] = (salesMap[item.code] || 0) + convertedQty;
                        itemCount++;
                        console.log(`Ù…Ø¨ÙŠØ¹Ø§Øª Ø¨Ø§Ù„Ø§Ø³Ù…: ${item.code} (${item.name}) = ${usageQty} ${unitText} -> ${convertedQty}`);
                    }
                }
            }
        }
    }
    
    Object.keys(salesMap).forEach(code => {
        const item = parsedData.find(item => item.code === code);
        if (item) {
            item.sales = salesMap[code];
            // Ù„Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† K1070 Ø¨Ø§Ù„ÙƒÙŠÙ„Ùˆ
            if (code === 'K1070') {
                console.log(`Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© Ù„Ù€ K1070: ${item.sales} ÙƒÙŠÙ„Ùˆ`);
            }
        }
    });
    
    console.log(`ØªÙ… ØªØ­Ù„ÙŠÙ„ ${itemCount} ØµÙ†Ù Ù„Ù„Ù…Ø¨ÙŠØ¹Ø§Øª`);
}
        // ØªØ­Ù„ÙŠÙ„ Ø´ÙŠØª Ø§Ù„Ø¬Ø±Ø¯ Ø§Ù„ÙØ¹Ù„ÙŠ Ù„Ù„Ø£ØµÙ†Ø§Ù Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© ************************************************************
        function parseActualInventoryForBaseItems(data, parsedData) {
            console.log("ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¬Ø±Ø¯ Ø§Ù„ÙØ¹Ù„ÙŠ");
            
            let headerRowIndex = -1;
            for (let i = 0; i < data.length; i++) {
                const row = data[i];
                if (row && row.length >= 4) {
                    if (row[0] && row[0].toString().includes('Ø§Ù„ÙƒÙˆØ¯')) {
                        headerRowIndex = i;
                        break;
                    }
                }
            }
            
            if (headerRowIndex === -1) {
                console.log("Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¹Ù†Ø§ÙˆÙŠÙ† ÙÙŠ Ø§Ù„Ø¬Ø±Ø¯ Ø§Ù„ÙØ¹Ù„ÙŠ");
                return;
            }
            
            let itemCount = 0;
            for (let i = headerRowIndex + 1; i < data.length; i++) {
                const row = data[i];
                if (row && row.length >= 4) {
                    const code = String(row[0] || '').trim();
                    const actual = parseFloat(row[3]) || 0;
                    
                    if (code) {
                        const item = parsedData.find(item => item.code === code);
                        if (item) {
                            item.actual = actual;
                            itemCount++;
                            console.log(`Ø¬Ø±Ø¯ ÙØ¹Ù„ÙŠ: ${code} = ${actual}`);
                        }
                    }
                }
            }
            
            console.log(`ØªÙ… ØªØ­Ù„ÙŠÙ„ ${itemCount} ØµÙ†Ù Ù„Ù„Ø¬Ø±Ø¯ Ø§Ù„ÙØ¹Ù„ÙŠ`);
        }

        // ØªØ­Ù„ÙŠÙ„ Ø´ÙŠØª Ø§Ù„ØªÙˆØ§Ù„Ù Ù„Ù„Ø£ØµÙ†Ø§Ù Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
        function parseWastageForBaseItems(data, parsedData) {
            console.log("ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØªÙˆØ§Ù„Ù");
            
            let headerRowIndex = -1;
            for (let i = 0; i < data.length; i++) {
                const row = data[i];
                if (row && row.length >= 6) {
                    if (row[2] && row[2].toString().includes('RM Code')) {
                        headerRowIndex = i;
                        break;
                    }
                }
            }
            
            if (headerRowIndex === -1) {
                console.log("Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¹Ù†Ø§ÙˆÙŠÙ† ÙÙŠ Ø§Ù„ØªÙˆØ§Ù„Ù");
                return;
            }
            
            let itemCount = 0;
            for (let i = headerRowIndex + 1; i < data.length; i++) {
                const row = data[i];
                if (row && row.length >= 6) {
                    const code = String(row[2] || '').trim();
                    const wastage = parseFloat(row[5]) || 0;
                    const unitText = String(row[4] || '').trim();
                    
                    if (code) {
                        const item = parsedData.find(item => item.code === code);
                        if (item) {
                            const convertedQty = convertToSmallestUnit(wastage, unitText, code);
                            item.wastage += convertedQty;
                            itemCount++;
                            console.log(`ØªÙˆØ§Ù„Ù: ${code} = ${wastage} ${unitText} -> ${convertedQty} ${item.unit}`);
                        }
                    }
                }
            }
            
            console.log(`ØªÙ… ØªØ­Ù„ÙŠÙ„ ${itemCount} ØµÙ†Ù Ù„Ù„ØªÙˆØ§Ù„Ù`);
        }

        // ØªØ­Ù„ÙŠÙ„ Ø´ÙŠØª Ø§Ù„ØªØ­ÙˆÙŠÙ„Ø§Øª Ù„Ù„Ø£ØµÙ†Ø§Ù Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
        function parseTransfersForBaseItems(data, parsedData, sheetName) {
            console.log(`ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØªØ­ÙˆÙŠÙ„Ø§Øª: ${sheetName}`);
            
            const isOutgoing = sheetName.includes('Ø®Ø§Ø±Ø¬Ø©') || sheetName.includes('out') || 
                               sheetName.includes('Ø®Ø§Ø±Ø¬') || sheetName.includes('Ø§Ù„Ø®Ø§Ø±Ø¬Ø©');
            const isIncoming = sheetName.includes('Ø¯Ø§Ø®Ù„Ø©') || sheetName.includes('in') || 
                               sheetName.includes('Ø¯Ø§Ø®Ù„') || sheetName.includes('Ø§Ù„Ø¯Ø§Ø®Ù„Ø©');
            
            if (!isOutgoing && !isIncoming) {
                console.log("Ù„ÙŠØ³ Ø´ÙŠØª ØªØ­ÙˆÙŠÙ„Ø§Øª: " + sheetName);
                return;
            }
            
            // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† ØµÙ Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ†
            let headerRowIndex = -1;
            for (let i = 0; i < data.length; i++) {
                const row = data[i];
                if (row && row.length >= 5) {
                    // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† RM Code ÙÙŠ Ø£ÙŠ Ø¹Ù…ÙˆØ¯
                    for (let j = 0; j < row.length; j++) {
                        if (row[j] && row[j].toString().includes('RM Code')) {
                            headerRowIndex = i;
                            break;
                        }
                    }
                    if (headerRowIndex !== -1) break;
                    
                    // Ø£Ùˆ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† vendor Name
                    if (row[0] && row[0].toString().includes('vendor Name')) {
                        headerRowIndex = i;
                        break;
                    }
                    
                    // Ø£Ùˆ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† # Ùˆ Group
                    if (row[0] && row[0].toString().includes('#') && row[1] && row[1].toString().includes('Group')) {
                        headerRowIndex = i;
                        break;
                    }
                }
            }
            
            if (headerRowIndex === -1) {
                console.log("Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¹Ù†Ø§ÙˆÙŠÙ† ÙÙŠ Ø§Ù„ØªØ­ÙˆÙŠÙ„Ø§Øª: " + sheetName);
                return;
            }
            
            // ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆØ§Ù‚Ø¹ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø©
            const headerRow = data[headerRowIndex];
            let rmCodeCol = -1;
            let rmNameCol = -1;
            let quantityCol = -1;
            let uomCol = -1;
            
            for (let j = 0; j < headerRow.length; j++) {
                const cell = headerRow[j];
                if (cell) {
                    const cellText = cell.toString().toLowerCase();
                    if (cellText.includes('rm code')) {
                        rmCodeCol = j;
                    } else if (cellText.includes('rm name') || cellText.includes('Ø§Ø³Ù…')) {
                        rmNameCol = j;
                    } else if (cellText.includes('quantity') || cellText.includes('ÙƒÙ…ÙŠØ©')) {
                        quantityCol = j;
                    } else if (cellText.includes('uom') || cellText.includes('ÙˆØ­Ø¯Ø©')) {
                        uomCol = j;
                    }
                }
            }
            
            // Ø¥Ø°Ø§ Ù„Ù… Ù†Ø¬Ø¯ Ø¨Ø§Ù„Ø¨Ø­Ø«ØŒ Ù†Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…ÙˆØ§Ø¶Ø¹ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ø­Ø³Ø¨ ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ù…Ù„Ù
            if (rmCodeCol === -1) {
                // ÙÙŠ Ø§Ù„ØªØ­ÙˆÙŠÙ„Ø§Øª Ø§Ù„Ø¯Ø§Ø®Ù„Ø©ØŒ RM Code ÙÙŠ Ø§Ù„Ø¹Ù…ÙˆØ¯ 2
                // ÙÙŠ Ø§Ù„ØªØ­ÙˆÙŠÙ„Ø§Øª Ø§Ù„Ø®Ø§Ø±Ø¬Ø©ØŒ RM Code ÙÙŠ Ø§Ù„Ø¹Ù…ÙˆØ¯ 1
                if (isIncoming) {
                    rmCodeCol = 2;
                } else if (isOutgoing) {
                    rmCodeCol = 1;
                }
            }
            
            if (quantityCol === -1) quantityCol = 4;
            if (uomCol === -1) uomCol = 3;
            
            console.log(`Ù…ÙˆØ§Ù‚Ø¹ Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© Ù„Ù„ØªØ­ÙˆÙŠÙ„Ø§Øª ${sheetName}:`, { rmCodeCol, rmNameCol, quantityCol, uomCol });
            
            // ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            let itemCount = 0;
            for (let i = headerRowIndex + 1; i < data.length; i++) {
                const row = data[i];
                if (row && row.length > Math.max(rmCodeCol, quantityCol)) {
                    let code = '';
                    
                    // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙˆØ¯
                    if (rmCodeCol !== -1 && row[rmCodeCol]) {
                        code = String(row[rmCodeCol]).trim();
                    }
                    
                    // Ø¥Ø°Ø§ Ù„Ù… Ù†Ø¬Ø¯ Ø§Ù„ÙƒÙˆØ¯ØŒ Ù†Ø­Ø§ÙˆÙ„ Ø§Ø³ØªØ®Ø±Ø§Ø¬Ù‡ Ù…Ù† Ø§Ø³Ù… Ø§Ù„ØµÙ†Ù
                    if (!code && rmNameCol !== -1 && row[rmNameCol]) {
                        const nameText = String(row[rmNameCol]);
                        const codeMatch = nameText.match(/([KAL]\d+)/);
                        if (codeMatch) {
                            code = codeMatch[0];
                        }
                    }
                    
                    if (code && (code.startsWith('K') || code.startsWith('A') || code.startsWith('L'))) {
                        const quantity = parseFloat(row[quantityCol]) || 0;
                        const unitText = uomCol !== -1 && row[uomCol] ? 
                            String(row[uomCol] || '').trim() : '';
                        
                        if (quantity > 0) {
                            const item = parsedData.find(item => item.code === code);
                            if (item) {
                                const convertedQty = convertToSmallestUnit(quantity, unitText, code);
                                if (isOutgoing) {
                                    item.transferOut += convertedQty;
                                    console.log(`ØªØ­ÙˆÙŠÙ„ Ø®Ø§Ø±Ø¬Ø©: ${code} = ${quantity} ${unitText} -> ${convertedQty} ${item.unit}`);
                                } else if (isIncoming) {
                                    item.transferIn += convertedQty;
                                    console.log(`ØªØ­ÙˆÙŠÙ„ Ø¯Ø§Ø®Ù„Ø©: ${code} = ${quantity} ${unitText} -> ${convertedQty} ${item.unit}`);
                                }
                                itemCount++;
                            }
                        }
                    }
                }
            }
            
            console.log(`ØªÙ… ØªØ­Ù„ÙŠÙ„ ${itemCount} ØµÙ†Ù Ù„Ù„ØªØ­ÙˆÙŠÙ„Ø§Øª ${sheetName}`);
        }

        // Ø¯Ø§Ù„Ø© Ø­ÙØ¸ PDF
        async function saveInventoryPDF() {
            if (!window.jspdf) {
                alert('Ù…ÙƒØªØ¨Ø© PDF ØºÙŠØ± Ù…Ø­Ù…Ù„Ø©. ÙŠØ±Ø¬Ù‰ ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙØ­Ø©.');
                return;
            }
            
            try {
                const element = document.getElementById('pdf-template');
                const selectedRestaurant = restaurantSearch.value;
                
                if (!selectedRestaurant) {
                    alert('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø·Ø¹Ù… Ø£ÙˆÙ„Ø§Ù‹');
                    return;
                }
                
                if (inventoryData.length === 0) {
                    alert('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ø¹Ø±Ø¶Ù‡Ø§ ÙÙŠ PDF. ÙŠØ±Ø¬Ù‰ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø£ÙˆÙ„Ø§Ù‹.');
                    return;
                }
                
                document.getElementById('pdf-restaurant-name').textContent = selectedRestaurant;
                
                const selectedDate = inventoryDate.value;
                const dateParts = selectedDate.split('-');
                const formattedDate = `${dateParts[2]}-${dateParts[1]}-${dateParts[0]}`;
                document.getElementById('pdf-inventory-date').textContent = formattedDate;
                
                const groupedDifferences = calculateGroupedDifferences(inventoryData);
                
                const pdfTableBody = document.getElementById('pdf-table-body');
                pdfTableBody.innerHTML = '';
                
                // ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ø³Ø¨ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª Ù„Ù…Ù„Ù PDF
                const pdfRowGroups = new Map();
                
                inventoryData.forEach((item, index) => {
                    const code = item.code;
                    let groupKey = null;
                    
                    if (groupedItems[code]) {
                        const group = groupedItems[code];
                        groupKey = group.sort().join('-');
                    } else {
                        groupKey = code; // ØµÙ†Ù ÙØ±Ø¯ÙŠ
                    }
                    
                    if (!pdfRowGroups.has(groupKey)) {
                        pdfRowGroups.set(groupKey, []);
                    }
                    pdfRowGroups.get(groupKey).push({ item, index });
                });
                
                // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØµÙÙˆÙ Ù„Ù…Ù„Ù PDF
                pdfRowGroups.forEach((groupItems, groupKey) => {
                    const isGrouped = groupItems.length > 1 && groupKey.includes('-');
                    const groupDiff = groupedDifferences[groupKey] ? groupedDifferences[groupKey].totalDifference : 0;
                    const roundedGroupDiff = roundToDecimal(groupDiff);
                    const groupDiffColor = roundedGroupDiff > 0 ? 'color: #38a169;' : roundedGroupDiff < 0 ? 'color: #c53030;' : '';
                    
                    groupItems.forEach((groupItem, groupIndex) => {
                        const item = groupItem.item;
                        
                        const closingBalance = item.opening + item.received + item.transferIn - item.transferOut - item.wastage - item.sales;
                        const difference = item.actual - closingBalance;
                        const finalBalance = item.endQty || item.actual;
                        const programDifference = finalBalance - closingBalance;
                        
                        // ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù‚ÙŠÙ… Ø¨Ø§Ù„Ø¬Ø±Ø§Ù… Ø¥Ù„Ù‰ ÙƒÙŠÙ„Ùˆ (Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„ÙˆØ­Ø¯Ø© Ø¬Ø±Ø§Ù…)
                        let displayOpening = item.opening;
                        let displayReceived = item.received;
                        let displayTransferIn = item.transferIn;
                        let displayTransferOut = item.transferOut;
                        let displayWastage = item.wastage;
                        let displaySales = item.sales;
                        let displayClosingBalance = closingBalance;
                        let displayActual = item.actual;
                        let displayFinalBalance = finalBalance;
                        
                        // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„ÙˆØ­Ø¯Ø© Ø¬Ø±Ø§Ù…ØŒ Ù†Ù‚Ø³Ù… Ø¹Ù„Ù‰ 1000 Ù„ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ ÙƒÙŠÙ„Ùˆ
                        if (item.unit === 'gram') {
                            displayOpening = convertGramToKilo(item.opening);
                            displayReceived = convertGramToKilo(item.received);
                            displayTransferIn = convertGramToKilo(item.transferIn);
                            displayTransferOut = convertGramToKilo(item.transferOut);
                            displayWastage = convertGramToKilo(item.wastage);
                            displaySales = convertGramToKilo(item.sales);
                            displayClosingBalance = convertGramToKilo(closingBalance);
                            displayActual = convertGramToKilo(item.actual);
                            displayFinalBalance = convertGramToKilo(finalBalance);
                        }
                        
                        // ØªÙ‚Ø±ÙŠØ¨ Ø§Ù„Ø£Ø±Ù‚Ø§Ù…
                        const roundedOpening = roundToDecimal(displayOpening);
                        const roundedReceived = roundToDecimal(displayReceived);
                        const roundedTransferIn = roundToDecimal(displayTransferIn);
                        const roundedTransferOut = roundToDecimal(displayTransferOut);
                        const roundedWastage = roundToDecimal(displayWastage);
                        const roundedSales = roundToDecimal(displaySales);
                        const roundedClosingBalance = roundToDecimal(displayClosingBalance);
                        const roundedActual = roundToDecimal(displayActual);
                        const roundedDifference = roundToDecimal(difference);
                        const roundedFinalBalance = roundToDecimal(displayFinalBalance);
                        const roundedProgramDifference = roundToDecimal(programDifference);
                        
                        const salesColor = roundedSales > 0 ? 'color: #c53030;' : '';
                        const wastageColor = roundedWastage > 0 ? 'color: #c53030;' : '';
                        const transferOutColor = roundedTransferOut > 0 ? 'color: #c53030;' : '';
                        const diffColor = roundedDifference > 0 ? 'color: #38a169;' : roundedDifference < 0 ? 'color: #c53030;' : '';
                        const programDiffColor = roundedProgramDifference > 0 ? 'color: #38a169;' : roundedProgramDifference < 0 ? 'color: #c53030;' : '';
                        
                        const displayValue = (val) => val > 0 ? val.toFixed(1) : '-';
                        
                        const row = document.createElement('tr');
                        
                        // Ø¨Ù†Ø§Ø¡ HTML Ù„Ù„ØµÙ ÙÙŠ PDF
                        let rowHtml = `
                            <td style="padding: 3px; border: 1px solid #000; text-align: center; font-weight: bold;">${item.code}</td>
                            <td style="padding: 3px; border: 1px solid #000; text-align: right; font-size: 9px; direction: rtl;">${item.name}</td>
                            <td style="padding: 3px; border: 1px solid #000; text-align: center;">${displayValue(roundedOpening)}</td>
                            <td style="padding: 3px; border: 1px solid #000; text-align: center;">${item.unit === 'gram' ? 'kilo' : item.unit}</td>
                            <td style="padding: 3px; border: 1px solid #000; text-align: center;">${displayValue(roundedReceived)}</td>
                            <td style="padding: 3px; border: 1px solid #000; text-align: center;">${displayValue(roundedTransferIn)}</td>
                            <td style="padding: 3px; border: 1px solid #000; text-align: center; ${transferOutColor}">${displayValue(roundedTransferOut)}</td>
                            <td style="padding: 3px; border: 1px solid #000; text-align: center; ${wastageColor}">${displayValue(roundedWastage)}</td>
                            <td style="padding: 3px; border: 1px solid #000; text-align: center; ${salesColor}">${displayValue(roundedSales)}</td>
                            <td style="padding: 3px; border: 1px solid #000; text-align: center; font-weight: bold;">${roundedClosingBalance > 0 ? roundedClosingBalance.toFixed(1) : '-'}</td>
                            <td style="padding: 3px; border: 1px solid #000; text-align: center; font-weight: bold;">${displayValue(roundedActual)}</td>
                            <td style="padding: 3px; border: 1px solid #000; text-align: center; font-weight: bold; ${diffColor}">${roundedDifference > 0 ? '+' : ''}${roundedDifference !== 0 ? roundedDifference.toFixed(1) : '-'}</td>
                        `;
                        
                        // Ø¥Ø¶Ø§ÙØ© Ø®Ù„ÙŠØ© ØªØ¬Ù…ÙŠØ¹ Ø§Ù„ÙØ±ÙˆÙ‚Ø§Øª ÙÙŠ PDF
                        if (groupIndex === 0 && isGrouped) {
                            // Ø£ÙˆÙ„ ØµÙ ÙÙŠ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ù…Ø¯Ù…Ø¬Ø©
                            rowHtml += `
                                <td style="padding: 3px; border: 1px solid #000; text-align: center; font-weight: bold; font-size: 11px; ${groupDiffColor}" rowspan="${groupItems.length}">
                                    ${roundedGroupDiff > 0 ? '+' : ''}${roundedGroupDiff !== 0 ? roundedGroupDiff.toFixed(1) : '-'}
                                </td>
                            `;
                        } else if (!isGrouped) {
                            // ØµÙ†Ù ÙØ±Ø¯ÙŠ
                            const individualDiff = roundedDifference;
                            const individualDiffColor = individualDiff > 0 ? 'color: #38a169;' : individualDiff < 0 ? 'color: #c53030;' : '';
                            rowHtml += `
                                <td style="padding: 3px; border: 1px solid #000; text-align: center; font-weight: bold; font-size: 11px; ${individualDiffColor}">
                                    ${individualDiff > 0 ? '+' : ''}${individualDiff !== 0 ? individualDiff.toFixed(1) : '-'}
                                </td>
                            `;
                        } else {
                            // ØµÙÙˆÙ Ù„Ø§Ø­Ù‚Ø© ÙÙŠ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ù…Ø¯Ù…Ø¬Ø© - Ù†ØªØ±Ùƒ Ø§Ù„Ø®Ù„ÙŠØ© ÙØ§Ø±ØºØ©
                            rowHtml += `<td style="padding: 3px; border: 1px solid #000;"></td>`;
                        }
                        
                        // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¹Ù…ÙˆØ¯ÙŠÙ† Ø§Ù„Ø£Ø®ÙŠØ±ÙŠÙ† ÙÙŠ PDF
                        rowHtml += `
                            <td style="padding: 3px; border: 1px solid #000; text-align: center; font-weight: bold;">${displayValue(roundedFinalBalance)}</td>
                            <td style="padding: 3px; border: 1px solid #000; text-align: center; font-weight: bold; ${programDiffColor}">${roundedProgramDifference > 0 ? '+' : ''}${roundedProgramDifference !== 0 ? roundedProgramDifference.toFixed(1) : '-'}</td>
                        `;
                        
                        row.innerHTML = rowHtml;
                        pdfTableBody.appendChild(row);
                    });
                });
                
                const originalDisplay = element.style.display;
                const originalPosition = element.style.position;
                const originalLeft = element.style.left;
                const originalTop = element.style.top;
                const originalWidth = element.style.width;
                const originalHeight = element.style.height;
                const originalZIndex = element.style.zIndex;
                
                element.style.display = 'block';
                element.style.position = 'fixed';
                element.style.left = '0';
                element.style.top = '0';
                element.style.width = '1123px';
                element.style.height = '794px';
                element.style.zIndex = '10000';
                element.style.background = 'white';
                element.style.padding = '10px';
                
                const canvas = await html2canvas(element, {
                    scale: 2,
                    useCORS: true,
                    logging: false,
                    backgroundColor: '#FFFFFF',
                    width: 1123,
                    height: 794,
                    windowWidth: 1123,
                    windowHeight: 794
                });
                
                element.style.display = originalDisplay;
                element.style.position = originalPosition;
                element.style.left = originalLeft;
                element.style.top = originalTop;
                element.style.width = originalWidth;
                element.style.height = originalHeight;
                element.style.zIndex = originalZIndex;
                
                const imgData = canvas.toDataURL('image/jpeg', 0.95);
                const pdf = new window.jspdf.jsPDF('l', 'pt', 'a4');
                
                const imgWidth = pdf.internal.pageSize.getWidth();
                const imgHeight = (canvas.height * imgWidth) / canvas.width;
                
                pdf.addImage(imgData, 'JPEG', 0, 0, imgWidth, imgHeight);
                
                const cleanRestaurantName = selectedRestaurant.replace(/[^\w\u0600-\u06FF\s]/g, '');
                const fileName = `ØªÙ‚Ø±ÙŠØ±_Ø¬Ø±Ø¯_${cleanRestaurantName}_${dateParts[2]}-${dateParts[1]}-${dateParts[0]}.pdf`;
                
                pdf.save(fileName);
                
            } catch (error) {
                console.error('Error generating PDF:', error);
                alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù PDF: ' + error.message);
            }
        }

        // Ù…Ø³Ø­ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        function clearData() {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©ØŸ')) {
                inventoryData = [];
                tableBody.innerHTML = '';
                excelFileInput.value = '';
                alert('ØªÙ… Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­.');
            }
        }

        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
        function initializeEvents() {
            excelFileInput.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const validExtensions = ['.xlsx', '.xls', '.xlsm'];
                    const fileExtension = file.name.slice(file.name.lastIndexOf('.')).toLowerCase();
                    
                    if (validExtensions.includes(fileExtension)) {
                        handleExcelFile(file);
                    } else {
                        alert('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù Excel ØµØ§Ù„Ø­ (Ø§Ù…ØªØ¯Ø§Ø¯ .xlsx Ø£Ùˆ .xls Ø£Ùˆ .xlsm)');
                    }
                }
            });
            
            exportPdfBtn.addEventListener('click', saveInventoryPDF);
            clearDataBtn.addEventListener('click', clearData);
            
            restaurantSearch.addEventListener('change', function() {
                if (this.value && inventoryData.length > 0) {
                    loadInventoryData();
                }
            });
            
            inventoryDate.addEventListener('change', function() {
                if (restaurantSearch.value && inventoryData.length > 0) {
                    loadInventoryData();
                }
            });
        }

        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        function initializeApp() {
            initializeDate();
            initializeRestaurantSearch();
            initializeEvents();
        }

        // ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        initializeApp();
    </script>
</body>
</html>